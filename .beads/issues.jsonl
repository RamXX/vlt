{"id":"VLT-0e0","title":"Add --tsv and --tree output formats","description":"## User Story\nAs a vault user, I want to output results in TSV (tab-separated values) and tree (hierarchical folder) formats so that I can integrate vlt output with other tools and visualize vault structure.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. Currently vlt supports --json, --csv, and --yaml output formats. The official Obsidian CLI additionally supports `text`, `tree`, `paths`, `md`, and `tsv`. This story adds the two most useful missing formats: `--tsv` and `--tree`.\n\n### TSV Format\nTab-separated values, similar to CSV but using tabs as delimiters. No quoting needed for most values (tabs are rare in note titles/paths). This is useful for piping to `awk`, `cut`, and other UNIX tools.\n\n**Behavior**: Same data as CSV but with tab delimiters and no quoting. First line is a header row.\n\nExample for search results:\n```\ntitle\tpath\nMy Note\tfolder/My Note.md\nOther\tOther.md\n```\n\n### Tree Format\nShows files in a hierarchical tree structure, like the `tree` command. This is useful for visualizing vault structure.\n\n**Behavior for list-type commands** (files, orphans, etc.):\n```\nvault/\n├── folder/\n│   ├── Note A.md\n│   └── Note B.md\n├── other/\n│   └── Note C.md\n└── Root Note.md\n```\n\n**Behavior for non-list commands** (search, tags, links): Not applicable. Tree format should return an error like \"tree format not supported for this command\" when used with commands that produce tabular data (tags with counts, links with broken flag, etc.).\n\n### Implementation\n1. Add `--tsv` and `--tree` to `outputFormat()` in `format.go`\n2. Add TSV output to all format* functions in `format.go`:\n   - `formatList()` -- TSV: one column\n   - `formatTable()` -- TSV: tab-separated columns\n   - `formatSearchResults()` -- TSV: title\\tpath\n   - `formatLinks()` -- TSV: target\\tpath\\tbroken\n   - `formatUnresolved()` -- TSV: target\\tsource\n   - `formatTagCounts()` -- TSV: tag\\tcount\n   - `formatVaults()` -- TSV: name\\tpath\n   - `formatProperties()` -- TSV: key\\tvalue\n3. Add tree output to `formatList()` only (the function that outputs []string paths):\n   - Parse paths into a tree structure\n   - Render using Unicode box-drawing characters (├── └── │)\n   - Sort directories first, then files\n4. Add \"tsv\" and \"tree\" to knownCommands/flags in `main.go`\n5. Update usage text\n\n### Files to Modify\n- `format.go` -- add TSV cases to all format functions; add tree rendering for formatList()\n- `main.go` -- add --tsv and --tree to outputFormat(), update usage text\n- `format_test.go` -- add tests\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestOutputFormatTSV` -- --tsv flag returns \"tsv\"\n2. `TestOutputFormatTree` -- --tree flag returns \"tree\"\n3. `TestFormatListTSV` -- formatList() with TSV outputs tab-separated single column\n4. `TestFormatTableTSV` -- formatTable() with TSV outputs tab-separated header + rows\n5. `TestFormatSearchResultsTSV` -- correct TSV output for search results\n6. `TestFormatLinksTSV` -- correct TSV output for links\n7. `TestFormatUnresolvedTSV` -- correct TSV output for unresolved\n8. `TestFormatTagCountsTSV` -- correct TSV output for tag counts\n9. `TestFormatVaultsTSV` -- correct TSV output for vaults\n10. `TestFormatListTree` -- formatList() with tree format renders hierarchical structure\n11. `TestFormatListTreeSingleFile` -- single file renders without tree lines\n12. `TestFormatListTreeNestedFolders` -- deeply nested folders render correctly\n13. `TestFormatListTreeEmpty` -- empty list renders nothing\n\n### Integration Tests (real files, no mocks)\n14. `TestFilesTSVIntegration` -- create vault with files in t.TempDir(), run cmdFiles with --tsv, verify output\n15. `TestFilesTreeIntegration` -- create vault with nested folders, run cmdFiles with --tree, verify tree output\n16. `TestSearchTSVIntegration` -- search results in TSV format\n17. `TestOrphansTSVIntegration` -- orphans in TSV format\n18. `TestOrphansTreeIntegration` -- orphans in tree format\n\n## Acceptance Criteria\n1. --tsv flag produces tab-separated output across all commands\n2. --tree flag produces hierarchical tree output for list commands\n3. Tree uses Unicode box-drawing characters (no ASCII fallback needed)\n4. TSV includes header row\n5. Existing --json, --csv, --yaml formats unchanged\n6. All existing tests pass\n7. 18+ new tests, all passing\n8. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go string formatting. No specialized skill requirements.","acceptance_criteria":"1. --tsv produces tab-separated output\n2. --tree produces hierarchical tree\n3. All format functions support TSV\n4. Tree uses Unicode box-drawing\n5. Existing formats unchanged\n6. All existing tests pass\n7. 18+ new tests passing","status":"open","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:27:51Z","created_by":"RamXX","updated_at":"2026-02-20T04:35:16Z","labels":["3sp"],"dependencies":[{"issue_id":"VLT-0e0","depends_on_id":"VLT-p02","type":"parent-child","created_at":"2026-02-19T20:27:55Z","created_by":"RamXX","metadata":"{}"}]}
{"id":"VLT-0l1","title":"Add automatic timestamp management (created_at/updated_at) for content operations","description":"## User Story\nAs a vault user, I want vlt to automatically manage `created_at` and `updated_at` frontmatter properties when I create, write, append, prepend, or patch notes, so that my notes have accurate modification history without manual updates.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. Currently no content operation touches frontmatter timestamps. This story adds opt-in automatic timestamp management.\n\n### Behavior\nWhen the `timestamps` flag is provided, vlt automatically manages two frontmatter properties:\n- `created_at` -- set to current UTC time (ISO 8601: `2026-02-19T14:30:00Z`) on `create` only. Never overwritten if already present.\n- `updated_at` -- set to current UTC time on `create`, `write`, `append`, `prepend`, and `patch`. Always overwritten.\n\n**Opt-in via flag**: `vlt vault=\"X\" create name=\"Note\" path=\"note.md\" content=\"...\" timestamps`\n**Opt-in via env var**: `VLT_TIMESTAMPS=1` (always-on for all operations)\n\nWithout the flag or env var, behavior is unchanged (no timestamps added).\n\n### Implementation Details\n- If the note has no frontmatter and timestamps is requested on create, ADD frontmatter with the timestamps\n- If the note has frontmatter, use `cmdPropertySet()` logic (or inline equivalent) to set/update the properties\n- For `write`, `append`, `prepend`, `patch`: only `updated_at` is set (the note already exists)\n- For `create`: both `created_at` and `updated_at` are set\n- If `created_at` already exists in frontmatter, do NOT overwrite it (preserve the original creation time)\n- Timestamp format: ISO 8601 UTC (`2006-01-02T15:04:05Z` in Go)\n\n### Files to Modify\n- `commands.go` -- modify `cmdCreate()`, `cmdWrite()` (from VLT-9ps), `cmdAppend()`, `cmdPrepend()`, `cmdPatch()` (from VLT-54o) to check for timestamps flag/env var and call timestamp logic\n- `frontmatter.go` -- add `ensureTimestamps(text string, isCreate bool) string` helper\n- `main.go` -- update usage text, pass timestamps flag to commands\n- Tests in relevant test files\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestEnsureTimestampsCreate` -- both created_at and updated_at set\n2. `TestEnsureTimestampsUpdate` -- only updated_at set, created_at preserved\n3. `TestEnsureTimestampsPreservesCreatedAt` -- existing created_at not overwritten\n4. `TestEnsureTimestampsNoFrontmatter` -- frontmatter added if not present\n5. `TestEnsureTimestampsFormat` -- timestamps use ISO 8601 UTC format\n\n### Integration Tests (real files, no mocks)\n6. `TestCreateWithTimestamps` -- create note with timestamps flag in t.TempDir(), verify both properties set\n7. `TestAppendWithTimestamps` -- append to existing note, verify updated_at changed, created_at unchanged\n8. `TestPrependWithTimestamps` -- prepend to note, verify updated_at set\n9. `TestWriteWithTimestamps` -- write to note, verify updated_at set, created_at preserved\n10. `TestPatchWithTimestamps` -- patch note by heading with timestamps, verify updated_at set, created_at preserved\n11. `TestTimestampsEnvVar` -- set VLT_TIMESTAMPS=1, create note without flag, verify timestamps set\n12. `TestNoTimestampsWithoutFlag` -- create/append without flag, verify no timestamps added\n13. `TestTimestampsPreserveExistingFrontmatter` -- existing frontmatter properties preserved when timestamps added\n14. `TestPatchByLineWithTimestamps` -- patch by line number with timestamps, verify updated_at set\n\n## Acceptance Criteria\n1. `timestamps` flag enables automatic timestamp management\n2. `VLT_TIMESTAMPS=1` env var enables timestamps globally\n3. `created_at` set on create, never overwritten\n4. `updated_at` set on create, write, append, prepend, AND patch\n5. ISO 8601 UTC format (2006-01-02T15:04:05Z)\n6. Frontmatter created if not present (when timestamps enabled)\n7. Existing frontmatter properties preserved\n8. No timestamps without flag/env var (backward compatible)\n9. Updated help text\n10. All existing tests pass\n11. 14+ new tests, all passing\n12. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go time package, string manipulation. No specialized skill requirements.","acceptance_criteria":"1. timestamps flag works for create/write/append/prepend/patch\n2. VLT_TIMESTAMPS env var works\n3. created_at never overwritten\n4. updated_at always refreshed (including patch)\n5. ISO 8601 UTC format\n6. Backward compatible without flag\n7. All existing tests pass\n8. 14+ new tests passing","notes":"Implementation complete. All 14 new tests pass, all existing tests pass (336 total).\n\n## Proof of passing tests\n\n14 new timestamp tests:\n- TestEnsureTimestampsCreate -- PASS\n- TestEnsureTimestampsUpdate -- PASS\n- TestEnsureTimestampsPreservesCreatedAt -- PASS\n- TestEnsureTimestampsNoFrontmatter -- PASS\n- TestEnsureTimestampsFormat -- PASS\n- TestCreateWithTimestamps -- PASS\n- TestAppendWithTimestamps -- PASS\n- TestPrependWithTimestamps -- PASS\n- TestWriteWithTimestamps -- PASS\n- TestPatchWithTimestamps -- PASS\n- TestTimestampsEnvVar -- PASS\n- TestNoTimestampsWithoutFlag -- PASS\n- TestTimestampsPreserveExistingFrontmatter -- PASS\n- TestPatchByLineWithTimestamps -- PASS\n\nFull suite: ok github.com/RamXX/vlt 0.404s (336 PASS, 0 FAIL)\n\n## AC Verification\n\n1. timestamps flag works for create/write/append/prepend/patch -- VERIFIED (tests 6-10, 14)\n2. VLT_TIMESTAMPS env var works -- VERIFIED (test 11)\n3. created_at never overwritten -- VERIFIED (tests 3, 7, 9, 10, 14)\n4. updated_at always refreshed (including patch) -- VERIFIED (tests 7-10, 14)\n5. ISO 8601 UTC format -- VERIFIED (test 5)\n6. Backward compatible without flag -- VERIFIED (test 12)\n7. All existing tests pass -- VERIFIED (336 total, 0 failures)\n8. 14+ new tests passing -- VERIFIED (exactly 14)","status":"closed","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:27:04Z","created_by":"RamXX","updated_at":"2026-02-20T05:47:55Z","closed_at":"2026-02-20T05:47:55Z","close_reason":"Accepted: All 14 timestamp tests pass (336 total, 0 failures). All 12 ACs verified. timestampsEnabled() correctly handles flag and VLT_TIMESTAMPS env var. ensureTimestamps() correctly sets both created_at and updated_at on create, only updated_at on update, never overwrites existing created_at. ISO 8601 UTC format confirmed. Integration tests use real filesystem, no mocks. Existing frontmatter properties preserved. Backward compatible without flag. Help text updated.","labels":["3sp","accepted"],"dependencies":[{"issue_id":"VLT-0l1","depends_on_id":"VLT-54o","type":"blocks","created_at":"2026-02-19T20:37:51Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-0l1","depends_on_id":"VLT-6z0","type":"parent-child","created_at":"2026-02-19T20:27:08Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-0l1","depends_on_id":"VLT-9ps","type":"blocks","created_at":"2026-02-19T20:27:08Z","created_by":"RamXX","metadata":"{}"}]}
{"id":"VLT-0s5","title":"Inert Zone Parsing -- Eliminate False Positives in Link/Tag Extraction","description":"vlt currently has NO concept of 'inert zones' -- content regions where wikilinks and tags should NOT be detected. This causes false positives in backlinks, links, orphans, unresolved, tags, and search commands. Content inside fenced code blocks, inline code, Obsidian comments (%% ... %%), HTML comments (\u003c\\!-- ... --\u003e), and math blocks ($$ ... $$ and $ ... $) is incorrectly scanned for [[wikilinks]] and #tags. The fix is architectural: introduce a content-masking pass that replaces inert zone content with spaces (preserving line count and byte offsets) BEFORE any wikilink/tag extraction. This epic delivers a new file inert.go with the masking infrastructure, then extends it to cover each zone type, and finally wires it into all consumer functions.","acceptance_criteria":"1. wikilinks inside fenced code blocks, inline code, Obsidian comments, HTML comments, and math blocks are NOT detected by parseWikilinks(). 2. Tags inside those same zones are NOT detected by parseInlineTags(). 3. All existing commands (backlinks, links, orphans, unresolved, tags, tag, search) respect inert zones. 4. No regressions in existing test suite (155+ tests). 5. Coverage for inert zone handling \u003e= 90%.","status":"open","priority":1,"issue_type":"epic","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:21:29Z","created_by":"RamXX","updated_at":"2026-02-20T04:21:29Z","labels":["milestone"]}
{"id":"VLT-0z7","title":"Walking Skeleton: Inert zone masking infrastructure with fenced code block support","description":"## User Story\nAs a vault user, I want wikilinks and tags inside fenced code blocks to be ignored so that code examples containing [[brackets]] or #tags do not pollute my link graph or tag index.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. It currently has NO concept of \"inert zones.\" Every function that extracts wikilinks or tags scans raw file content, including content inside fenced code blocks (triple backticks). This causes false positives in `backlinks`, `links`, `orphans`, `unresolved`, `tags`, `tag`, and `search` commands.\n\nThis story introduces the **architectural foundation** for inert zone handling: a `maskInertContent()` function that replaces content inside inert zones with spaces (preserving byte length and line count) so that downstream regex-based parsers never see the masked content. This first story implements masking for **fenced code blocks** only (` ``` ... ``` `), including language-tagged blocks like ` ```go ... ``` ` and ` ```mermaid ... ``` `.\n\n### Architecture -- Registered Passes Pattern\n- New file: `inert.go` -- contains `maskInertContent(text string) string` and the pass-registration infrastructure\n- New file: `inert_test.go` -- tests for the masking infrastructure\n- **CRITICAL DESIGN DECISION**: `maskInertContent()` must use a **registered-passes pattern** to avoid parallel modification conflicts. Instead of a monolithic function body that each subsequent story modifies, the design is:\n  ```go\n  // maskPass is a function that masks one type of inert zone.\n  type maskPass func(text string) string\n\n  // inertPasses is the ordered slice of mask functions.\n  // Each story adds its pass to this slice via an init() function or by\n  // appending in a file-scoped var block. Order matters:\n  // fenced code blocks first, then inline code, then comments, then math.\n  var inertPasses []maskPass\n\n  // registerMaskPass adds a masking pass. Called during init.\n  func registerMaskPass(p maskPass) {\n      inertPasses = append(inertPasses, p)\n  }\n\n  // maskInertContent applies all registered masking passes in order.\n  func maskInertContent(text string) string {\n      for _, pass := range inertPasses {\n          text = pass(text)\n      }\n      return text\n  }\n  ```\n- This story registers the fenced code block pass. Subsequent stories (inline code, comments, math) each register their own pass by calling `registerMaskPass()` in their own init() functions. This means each story ADDS a new file or appends to inert.go without modifying the maskInertContent() function body, eliminating merge conflicts.\n- **Wire into consumers**: modify `parseWikilinks()` in `wikilinks.go` and `parseInlineTags()` in `tags.go` to call `maskInertContent()` before running their regex extraction. Also modify `findBacklinks()` in `wikilinks.go` to mask before matching.\n- `cmdOrphans()` and `cmdUnresolved()` in `commands.go` both call `parseWikilinks()`, so they automatically benefit\n- `allNoteTags()` in `tags.go` calls `parseInlineTags()`, so `tags` and `tag` commands automatically benefit\n- `cmdLinks()` calls `parseWikilinks()`, so it automatically benefits\n- `cmdSearch()` in `commands.go` searches content -- it should NOT mask content (search should find text everywhere)\n\n### Masking Strategy\nThe masking function replaces **non-newline characters** inside inert zones with space characters (0x20). **Newline characters are preserved.** This means:\n- Line numbers are preserved (newlines within masked zones stay as newlines)\n- Byte length is preserved (each non-newline byte maps to a space)\n- The fence delimiters themselves are NOT masked (so ```go stays visible for debugging)\n- Helper function: `maskRegion(text string, start, end int) string` -- replaces all non-newline chars in text[start:end] with spaces\n\n### Fenced Code Block Details\n- Matches: ` ```language\\n ... \\n``` ` where language is optional\n- Also matches Mermaid blocks (` ```mermaid ... ``` `) since Mermaid is just a fenced code block with language=mermaid\n- Regex: `(?m)^` ``` `\\w*\\n` to find opening fence, then scan for closing ` ``` ` at start of line\n- Unclosed fence at EOF: mask to end of file (matches Obsidian behavior)\n\n### Files to Modify\n- NEW: `inert.go` -- maskInertContent(), registerMaskPass(), maskPass type, maskRegion() helper, fenced code block pass registration\n- NEW: `inert_test.go` -- comprehensive tests\n- `wikilinks.go` -- modify parseWikilinks() to mask before extraction; modify findBacklinks() to mask before matching\n- `tags.go` -- modify parseInlineTags() to mask before extraction (but NOT frontmatter tags)\n- No changes to commands.go needed (consumers use parseWikilinks/parseInlineTags)\n\n## Testing Requirements (TDD)\nWrite tests FIRST in inert_test.go, then implement.\n\n### Unit Tests\n1. `TestMaskFencedCodeBlock` -- basic triple-backtick block is masked\n2. `TestMaskFencedCodeBlockWithLanguage` -- ```go, ```python etc. blocks are masked\n3. `TestMaskMermaidBlock` -- ```mermaid block is masked (explicit Mermaid/diagram test)\n4. `TestMaskPreservesLength` -- output length equals input length\n5. `TestMaskPreservesNewlines` -- newlines within masked zones are preserved as newlines (NOT replaced with spaces)\n6. `TestMaskNonFencedContentUnchanged` -- text outside fences is untouched\n7. `TestMaskMultipleFencedBlocks` -- multiple blocks in one document\n8. `TestMaskUnclosedFence` -- unclosed fence at EOF: mask to end of file (Obsidian behavior)\n9. `TestMaskNestedBackticks` -- inline backticks inside fenced blocks do not interfere\n10. `TestMaskEmptyFencedBlock` -- empty ``` ... ``` block\n11. `TestRegisteredPassesPattern` -- verify registerMaskPass() adds passes and maskInertContent() calls them in order\n\n### Integration Tests (real files, no mocks)\n12. `TestParseWikilinksIgnoresFencedCode` -- parseWikilinks() with text containing [[Link]] inside fenced code returns NO links from the fenced zone\n13. `TestParseInlineTagsIgnoresFencedCode` -- parseInlineTags() with #tag inside fenced code returns NO tags from the fenced zone\n14. `TestFindBacklinksIgnoresFencedCode` -- create real vault with t.TempDir(), note A with [[B]] inside a code block. findBacklinks(vault, \"B\") must NOT return A.\n15. `TestOrphansIgnoresFencedCode` -- real vault: note A links to B only inside a code block. B should appear in orphans.\n16. `TestUnresolvedIgnoresFencedCode` -- real vault: [[Missing]] only inside code block. cmdUnresolved() should NOT report it.\n17. `TestLinksIgnoresFencedCode` -- real vault: note with [[Target]] inside code block. cmdLinks() should NOT list Target.\n18. `TestTagsIgnoresFencedCode` -- real vault: note with #mytag only inside code block. cmdTags() should NOT list mytag.\n19. `TestMermaidBlockIgnored` -- real vault: note with [[Link]] inside ```mermaid block. parseWikilinks() does NOT extract it.\n\n### E2E test (walking skeleton proof)\n20. `TestE2EInertZoneFencedCode` -- Create a complete vault with t.TempDir(). Create notes with wikilinks and tags both inside and outside fenced code blocks (including mermaid). Run the full command pipeline (backlinks, links, orphans, unresolved, tags) and verify only the non-fenced references are detected.\n\n## Acceptance Criteria\n1. New file `inert.go` exists with exported function `maskInertContent(text string) string`\n2. Registered-passes pattern implemented: `maskPass` type, `registerMaskPass()`, ordered pass execution\n3. Fenced code block content (``` ... ```) is masked -- wikilinks and tags inside are NOT extracted\n4. Language-tagged fenced blocks (```go, ```python, ```mermaid, etc.) are also masked\n5. Mermaid/diagram blocks explicitly tested and masked\n6. Masking preserves newlines (only non-newline characters replaced with spaces)\n7. `parseWikilinks()` calls `maskInertContent()` before extraction\n8. `parseInlineTags()` calls `maskInertContent()` before extraction\n9. `findBacklinks()` calls `maskInertContent()` before matching\n10. All 155+ existing tests continue to pass (zero regressions)\n11. Minimum 20 new tests, all passing\n12. Zero external dependencies (Go stdlib only)\n13. Can be demoed: run `vlt vault=\"test\" backlinks file=\"B\"` against a vault where [[B]] appears only inside a code block, and get empty results\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go patterns, regex, string manipulation. No specialized skill requirements.","acceptance_criteria":"1. inert.go exists with maskInertContent() and registered-passes pattern\n2. maskPass type, registerMaskPass(), ordered execution\n3. Fenced code blocks (``` and ```language) are masked\n4. Mermaid blocks (```mermaid) explicitly masked and tested\n5. Masking preserves newlines (non-newline chars become spaces)\n6. parseWikilinks() masks before extraction\n7. parseInlineTags() masks before extraction\n8. findBacklinks() masks before matching\n9. All 155+ existing tests pass\n10. 20+ new tests all passing\n11. Zero external dependencies\n12. Demoable end-to-end","notes":"## Delivery Proof\n\n### Files Created\n- `inert.go` -- maskInertContent(), registerMaskPass(), maskPass type, maskRegion() helper, fenced code block pass registration via init()\n- `inert_test.go` -- 20 new tests (11 unit, 8 integration, 1 E2E)\n\n### Files Modified\n- `wikilinks.go` -- parseWikilinks() and findBacklinks() now call maskInertContent() before extraction/matching\n- `tags.go` -- parseInlineTags() now calls maskInertContent() before extraction\n\n### Test Results\n- 115 total top-level tests, ALL PASSING\n- 20 new tests, ALL PASSING\n- 0 regressions across 95+ existing tests\n- Zero external dependencies (stdlib only)\n\n### Commit\nbee9084 feat(vlt): add inert zone masking infrastructure with fenced code block support","status":"closed","priority":1,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:22:14Z","created_by":"RamXX","updated_at":"2026-02-20T04:57:11Z","closed_at":"2026-02-20T04:57:11Z","close_reason":"Accepted: Inert zone masking infrastructure implemented correctly. All 12 ACs verified. inert.go provides maskInertContent() with registered-passes pattern. Fenced code block masking (including language-tagged and mermaid blocks) implemented with newline preservation. parseWikilinks(), parseInlineTags(), and findBacklinks() all call maskInertContent() before extraction. 20 new tests (11 unit, 8 integration real-vault no-mocks, 1 E2E), 115 total tests, 0 regressions. Zero external dependencies.","labels":["5sp","accepted"],"dependencies":[{"issue_id":"VLT-0z7","depends_on_id":"VLT-0s5","type":"parent-child","created_at":"2026-02-19T20:22:18Z","created_by":"RamXX","metadata":"{}"}]}
{"id":"VLT-15d","title":"E2E validation: All content manipulation commands work together end-to-end","description":"## User Story\nAs a vault user, I want confidence that all content manipulation commands (write, patch, read with heading, search with context, search with regex, timestamps) work correctly together in realistic workflows.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only). This is the final validation story for the Content Manipulation epic (VLT-6z0). All content commands have been implemented in prior stories. This story provides comprehensive E2E validation that the entire content manipulation suite works correctly with realistic vault content and realistic multi-step workflows.\n\nThis story does NOT add new command code. It adds E2E tests that exercise the full content manipulation pipeline with complex, realistic scenarios.\n\n### What This Story Validates\nThe complete content manipulation workflow:\n- `write` -- overwrite note body, preserving frontmatter\n- `patch` -- surgical edits by heading and line number (replace and delete)\n- `read` with heading= -- extract specific sections\n- `search` with context= -- find content with surrounding lines\n- `search` with regex= -- regex-based content search\n- Timestamps -- automatic created_at/updated_at management across all write operations\n\n### Files to Modify\n- Test file (e.g., `commands_test.go` or `e2e_test.go`) -- add comprehensive E2E tests\n\nNo production code changes. This is a validation-only story.\n\n## Testing Requirements\n\n### E2E Tests (real files, no mocks, t.TempDir())\n1. `TestE2EWriteThenReadHeading` -- Create note with frontmatter and multiple sections. Write new body. Read specific heading. Verify section content correct and frontmatter preserved.\n2. `TestE2EPatchThenReadHeading` -- Create note with sections. Patch one section by heading. Read that section with heading=. Verify patched content returned.\n3. `TestE2EPatchDeleteThenSearch` -- Create note with sections. Delete a section via patch. Search for content from deleted section. Verify it is not found.\n4. `TestE2ESearchContextMultipleNotes` -- Create vault with multiple notes. Search with context=2. Verify context lines from correct files with correct line numbers.\n5. `TestE2ESearchRegexAcrossVault` -- Create vault with notes containing dates, URLs, etc. Search with regex for date pattern. Verify correct matches.\n6. `TestE2ETimestampsFullWorkflow` -- Create note with timestamps flag. Verify created_at set. Append with timestamps. Verify updated_at changed but created_at preserved. Write with timestamps. Verify updated_at refreshed. Patch with timestamps. Verify updated_at refreshed again.\n7. `TestE2EWritePreservesLinks` -- Create note with wikilinks in body. Write new body with different wikilinks. Verify backlinks updated (old links gone from backlinks, new links appear).\n8. `TestE2EPatchByLineRange` -- Create note. Patch lines 3-7 with new content. Read back. Verify lines 1-2 unchanged, 3-7 replaced, rest unchanged.\n9. `TestE2EContentManipulationDoesNotCorruptVault` -- Perform multiple write/patch/append/prepend operations on several notes. Verify all notes in vault are valid (readable, frontmatter parseable, no truncation or corruption).\n\n## Acceptance Criteria\n1. 9 E2E tests, all passing\n2. All content manipulation commands tested in combination\n3. Timestamp lifecycle verified across multiple operations\n4. Write/patch operations verified to not corrupt vault\n5. Search context and regex verified across multi-note vaults\n6. All prior tests still pass (zero regressions)\n7. Demoable: can show realistic workflow of create -\u003e write -\u003e patch -\u003e read heading -\u003e search\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go testing patterns. No specialized skill requirements.","acceptance_criteria":"1. 9 E2E tests all passing\n2. All content manipulation commands tested in combination\n3. Timestamp lifecycle verified\n4. No vault corruption from operations\n5. All prior tests pass\n6. Demoable end-to-end","status":"open","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:36:51Z","created_by":"RamXX","updated_at":"2026-02-20T04:36:51Z","labels":["3sp"],"dependencies":[{"issue_id":"VLT-15d","depends_on_id":"VLT-0l1","type":"blocks","created_at":"2026-02-19T20:36:58Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-15d","depends_on_id":"VLT-4lr","type":"blocks","created_at":"2026-02-19T20:36:57Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-15d","depends_on_id":"VLT-54o","type":"blocks","created_at":"2026-02-19T20:36:57Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-15d","depends_on_id":"VLT-6z0","type":"parent-child","created_at":"2026-02-19T20:36:57Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-15d","depends_on_id":"VLT-9ps","type":"blocks","created_at":"2026-02-19T20:36:57Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-15d","depends_on_id":"VLT-aca","type":"blocks","created_at":"2026-02-19T20:36:58Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-15d","depends_on_id":"VLT-hha","type":"blocks","created_at":"2026-02-19T20:36:58Z","created_by":"RamXX","metadata":"{}"}]}
{"id":"VLT-4lr","title":"Add heading extraction to read command (read file=\"X\" heading=\"## Y\")","description":"## User Story\nAs a vault user, I want to read just one section of a note by specifying a heading, so that I can extract specific content without parsing the entire file.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. Currently `vlt read file=\"X\"` returns the entire note content. There is no way to read a specific section. This story adds an optional `heading=` parameter to the read command.\n\n### Behavior\n`vlt vault=\"X\" read file=\"Note\" heading=\"## Section\"` returns:\n- The heading line itself\n- All content until the next heading of equal or higher level (or EOF)\n- This is the same section-scoping logic used by the patch command (VLT-54o)\n\n`vlt vault=\"X\" read file=\"Note\"` (no heading=) continues to work as before -- returns the full note.\n\nIf the heading is not found, return an error: `heading \"## Section\" not found in \"Note\"`.\n\n### Section Boundary Logic\nSame algorithm as patch command: section extends from the heading line to the line before the next heading of equal or higher level.\n\nFor `## Section A` in:\n```\n## Section A\ncontent\n### Sub\nmore\n## Section B\n```\nReturns: `## Section A\\ncontent\\n### Sub\\nmore\\n`\n\n### Implementation\nModify `cmdRead()` in `commands.go`:\n1. Check for optional `heading` parameter\n2. If present, read file, split into lines, find heading, extract section\n3. Share section-boundary logic with cmdPatch (extract into a helper function, e.g., `findSection(lines []string, heading string) (start, end int, err error)`)\n\n### Files to Modify\n- `commands.go` -- modify `cmdRead()` to support heading= parameter, extract shared `findSection()` helper\n- `main.go` -- update usage text for read command\n- `main_test.go` -- add tests\n\n**Note**: The `findSection()` helper will be shared with the patch command. If the patch story has not yet been completed, implement the helper here. If it has, reuse it.\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestFindSection` -- helper function finds correct section boundaries\n2. `TestFindSectionAtEOF` -- section extends to EOF\n3. `TestFindSectionCaseInsensitive` -- heading match is case-insensitive\n4. `TestFindSectionNotFound` -- returns error for nonexistent heading\n5. `TestReadWithHeadingBasic` -- returns heading + section content\n6. `TestReadWithHeadingIncludesSubheadings` -- subsections included\n7. `TestReadWithoutHeading` -- existing behavior unchanged (full note returned)\n\n### Integration Tests (real files, no mocks)\n8. `TestReadHeadingIntegration` -- create note with multiple sections in t.TempDir(), read specific heading, verify correct content\n9. `TestReadHeadingWithFrontmatter` -- note with frontmatter, heading section does not include frontmatter\n10. `TestReadHeadingLastSection` -- read the last section (extends to EOF)\n11. `TestReadHeadingNotFoundIntegration` -- real note, nonexistent heading, verify error\n\n## Acceptance Criteria\n1. `read file=\"X\" heading=\"## Y\"` returns the specified section\n2. Section includes the heading line and all content until next equal-or-higher heading\n3. Case-insensitive heading match\n4. Error returned for nonexistent heading\n5. `read file=\"X\"` (no heading) works as before\n6. Updated help text\n7. All existing tests pass\n8. 11+ new tests, all passing\n9. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go string/line manipulation. No specialized skill requirements.","acceptance_criteria":"1. read with heading= returns correct section\n2. Section scope correct\n3. Case-insensitive heading match\n4. Error on not found heading\n5. Backward compatible (no heading= works as before)\n6. All existing tests pass\n7. 11+ new tests passing","status":"closed","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:26:06Z","created_by":"RamXX","updated_at":"2026-02-20T05:33:04Z","closed_at":"2026-02-20T05:33:04Z","close_reason":"Accepted: heading= parameter wired into cmdRead via reused findSection() helper; 11 tests (4 unit + 7 integration, real files, no mocks) all pass; backward compatibility preserved; help text updated.","labels":["3sp","accepted"],"dependencies":[{"issue_id":"VLT-4lr","depends_on_id":"VLT-54o","type":"blocks","created_at":"2026-02-19T20:35:27Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-4lr","depends_on_id":"VLT-6z0","type":"parent-child","created_at":"2026-02-19T20:26:10Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":2,"issue_id":"VLT-4lr","author":"RamXX","text":"C10 NOTE -- Heading search operates on RAW content, NOT masked content. The findSection() helper (shared with cmdPatch from VLT-54o) searches for headings in the original text, not in maskInertContent() output. Inert zone masking is for wikilink/tag extraction only -- heading-level structural analysis must see the real content. Headings at column 0 are always treated as section boundaries regardless of surrounding context.","created_at":"2026-02-20T04:38:29Z"},{"id":10,"issue_id":"VLT-4lr","author":"RamXX","text":"## Delivery Proof -- VLT-4lr\n\n### Implementation Summary\nModified cmdRead() in commands.go to support optional heading= parameter. Reuses the existing findSection() helper from VLT-54o. Updated help text in main.go.\n\n### Files Modified\n- commands.go: cmdRead() now checks for heading= param, uses findSection() to extract section bounds, returns heading + content\n- main.go: Updated usage text for read command, added example\n- main_test.go: Added 11 new tests (4 unit + 7 integration)\n\n### Test Results (all 11 new tests passing)\n1. TestFindSection -- PASS\n2. TestFindSectionAtEOF -- PASS\n3. TestFindSectionCaseInsensitive -- PASS\n4. TestFindSectionNotFound -- PASS\n5. TestReadWithHeadingBasic -- PASS\n6. TestReadWithHeadingIncludesSubheadings -- PASS\n7. TestReadWithoutHeading -- PASS\n8. TestReadHeadingIntegration -- PASS\n9. TestReadHeadingWithFrontmatter -- PASS\n10. TestReadHeadingLastSection -- PASS\n11. TestReadHeadingNotFoundIntegration -- PASS\n\n### Full Suite: All existing + new tests pass (0 failures)\n\n### AC Verification\n| AC | Status | Evidence |\n|----|--------|----------|\n| read with heading= returns correct section | PASS | TestReadWithHeadingBasic, TestReadHeadingIntegration |\n| Section scope correct | PASS | TestReadWithHeadingIncludesSubheadings, TestFindSection |\n| Case-insensitive heading match | PASS | TestFindSectionCaseInsensitive |\n| Error on not found heading | PASS | TestReadHeadingNotFoundIntegration |\n| Backward compatible | PASS | TestReadWithoutHeading |\n| All existing tests pass | PASS | Full suite green |\n| 11+ new tests passing | PASS | 11 tests, all PASS |","created_at":"2026-02-20T05:27:24Z"}]}
{"id":"VLT-54o","title":"Add section-targeted edits (patch by heading and line number)","description":"## User Story\nAs a vault user, I want to patch content at a specific heading or line number so that I can make surgical edits to notes without rewriting the entire body.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. The official Obsidian CLI provides a `patch` command with `--heading`, `--line`, `--replace`, and `--delete` flags for surgical edits. vlt currently has no equivalent. This story adds section-targeted edit capabilities.\n\n### Behavior\nThe `patch` command supports three modes:\n\n**1. Heading-targeted replace:**\n`vlt vault=\"X\" patch file=\"Note\" heading=\"## Section\" content=\"new section body\"`\n- Finds the heading line in the note\n- Replaces all content from the line AFTER the heading until the next heading of equal or higher level (or EOF)\n- Preserves the heading line itself\n- Heading match is case-insensitive and trims whitespace\n\n**2. Line-targeted replace:**\n`vlt vault=\"X\" patch file=\"Note\" line=\"5\" content=\"replacement line\"`\n- Replaces the content at the specified 1-based line number\n- Single line replacement by default\n\n**3. Delete mode:**\n`vlt vault=\"X\" patch file=\"Note\" heading=\"## Section\" delete`\n- Removes the heading and all its content (until next equal-or-higher heading or EOF)\n\n`vlt vault=\"X\" patch file=\"Note\" line=\"5\" delete`\n- Removes the specified line\n\n**4. Line range:**\n`vlt vault=\"X\" patch file=\"Note\" line=\"5-10\" content=\"replacement\"`\n- Replaces lines 5 through 10 with the provided content\n\n`vlt vault=\"X\" patch file=\"Note\" line=\"5-10\" delete`\n- Deletes lines 5 through 10\n\n### Heading Level Logic\nWhen patching by heading, the section extends from the heading to the line before the next heading of equal or higher level. For example, in:\n```\n## Section A\ncontent a\n### Subsection\nsub content\n## Section B\n```\nPatching `## Section A` replaces \"content a\", \"### Subsection\", and \"sub content\" (up to but not including `## Section B`).\n\n### Implementation\nAdd `cmdPatch()` to `commands.go`:\n1. Resolve note by title\n2. Read content, split into lines\n3. If heading= provided: find heading line, determine section boundary, replace/delete\n4. If line= provided: parse line number (or range \"N-M\"), replace/delete\n5. Write updated content back\n\nAdd \"patch\" to `knownCommands` and dispatch in `main.go`. Add to usage text.\n\n### Files to Modify\n- `commands.go` -- add `cmdPatch()` function and helper functions for section boundary detection\n- `main.go` -- add \"patch\" to knownCommands, add dispatch case, update usage text\n- `main_test.go` -- add tests\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestPatchByHeadingReplace` -- replace section content under ## heading\n2. `TestPatchByHeadingPreservesOtherSections` -- other sections unchanged\n3. `TestPatchByHeadingCaseInsensitive` -- heading match is case-insensitive\n4. `TestPatchByHeadingScopeToNextEqualLevel` -- subsections included in scope\n5. `TestPatchByHeadingAtEOF` -- section extends to end of file\n6. `TestPatchByHeadingDelete` -- heading + content removed\n7. `TestPatchByLineReplace` -- single line replacement\n8. `TestPatchByLineRangeReplace` -- line range \"5-10\" replacement\n9. `TestPatchByLineDelete` -- single line deletion\n10. `TestPatchByLineRangeDelete` -- line range deletion\n11. `TestPatchLineOutOfRange` -- error for line number beyond file length\n12. `TestPatchHeadingNotFound` -- error for nonexistent heading\n13. `TestPatchRequiresFile` -- error without file=\n\n### Integration Tests (real files, no mocks)\n14. `TestPatchByHeadingIntegration` -- create real note with multiple sections in t.TempDir(), patch one section, read back and verify\n15. `TestPatchByLineIntegration` -- create real note, patch specific line, verify with cmdRead\n16. `TestPatchDeleteSectionIntegration` -- delete a section, verify remaining content intact\n17. `TestPatchPreservesFrontmatter` -- patch does not corrupt frontmatter\n18. `TestPatchThenBacklinks` -- patch a section that contained wikilinks, verify backlinks updated\n\n## Acceptance Criteria\n1. `patch file=\"X\" heading=\"## Y\" content=\"...\"` replaces section content\n2. `patch file=\"X\" heading=\"## Y\" delete` removes section\n3. `patch file=\"X\" line=\"N\" content=\"...\"` replaces single line\n4. `patch file=\"X\" line=\"N-M\" content=\"...\"` replaces line range\n5. `patch file=\"X\" line=\"N\" delete` removes line\n6. `patch file=\"X\" line=\"N-M\" delete` removes line range\n7. Section scope correct (heading to next equal-or-higher heading)\n8. Heading match is case-insensitive\n9. Frontmatter preserved in all modes\n10. Error on nonexistent heading or out-of-range line\n11. \"patch\" in help text\n12. All existing tests pass\n13. 18+ new tests, all passing\n14. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go string manipulation. No specialized skill requirements.","acceptance_criteria":"1. patch by heading works (replace and delete)\n2. patch by line works (single and range, replace and delete)\n3. Section scope correct\n4. Heading match case-insensitive\n5. Frontmatter preserved\n6. Error handling correct\n7. All existing tests pass\n8. 18+ new tests passing","notes":"Implementation complete. All 18 tests pass (13 unit + 5 integration).\n\nProof of passing tests:\n- TestPatchByHeadingReplace: PASS\n- TestPatchByHeadingPreservesOtherSections: PASS\n- TestPatchByHeadingCaseInsensitive: PASS\n- TestPatchByHeadingScopeToNextEqualLevel: PASS\n- TestPatchByHeadingAtEOF: PASS\n- TestPatchByHeadingDelete: PASS\n- TestPatchByLineReplace: PASS\n- TestPatchByLineRangeReplace: PASS\n- TestPatchByLineDelete: PASS\n- TestPatchByLineRangeDelete: PASS\n- TestPatchLineOutOfRange: PASS\n- TestPatchHeadingNotFound: PASS\n- TestPatchRequiresFile: PASS\n- TestPatchByHeadingIntegration: PASS\n- TestPatchByLineIntegration: PASS\n- TestPatchDeleteSectionIntegration: PASS\n- TestPatchPreservesFrontmatter: PASS\n- TestPatchThenBacklinks: PASS\n\nAll existing tests also pass (0 regressions). Zero external dependencies.\nCommit: 0d28799 on main branch.","status":"closed","priority":3,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:25:41Z","created_by":"RamXX","updated_at":"2026-02-20T05:23:49Z","closed_at":"2026-02-20T05:23:49Z","close_reason":"Accepted: patch command fully implemented with heading-targeted replace/delete, line-targeted replace/delete (single and range), findSection() helper ready for VLT-4lr reuse. 18 tests (13 unit + 5 integration) all pass. No regressions. Zero external deps.","labels":["5sp","accepted"],"dependencies":[{"issue_id":"VLT-54o","depends_on_id":"VLT-6z0","type":"parent-child","created_at":"2026-02-19T20:25:45Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-54o","depends_on_id":"VLT-9ps","type":"blocks","created_at":"2026-02-19T20:25:46Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":1,"issue_id":"VLT-54o","author":"RamXX","text":"C10 NOTE -- Heading search operates on RAW content, NOT masked content. The findSection() helper must search for headings in the original text, not in maskInertContent() output. Headings inside code blocks (e.g., ```markdown with ## Example) should NOT match as section boundaries. However, this is already handled correctly because Markdown headings must start at column 0 with no indentation, while content inside fenced code blocks is typically indented. If a heading line appears at column 0 inside a fenced code block (edge case), it should still be treated as a heading for section scoping purposes -- this matches Obsidian behavior where fenced code blocks do not suppress heading-level structure.","created_at":"2026-02-20T04:38:22Z"}]}
{"id":"VLT-6z0","title":"Content Manipulation -- Write, Section Edits, Heading Read, Search Enhancements, Timestamps","description":"vlt currently supports create, append, and prepend for content operations, but is missing several key content manipulation capabilities that the official Obsidian CLI provides. This epic adds: (1) a 'write' command to overwrite note body content, (2) section-targeted edits via heading or line number, (3) heading extraction for read, (4) search context lines (like grep -C), (5) regex search support, and (6) automatic timestamp management in frontmatter. These features make vlt a complete content manipulation tool, closing the gap with the Obsidian CLI's patch command and enhancing search beyond the Obsidian CLI's capabilities.","acceptance_criteria":"1. write command overwrites note body content. 2. Section-targeted edits work by heading and line number (replace and delete modes). 3. read with heading= returns only the specified section. 4. search with context= shows surrounding lines. 5. search supports regex= for regex patterns. 6. Automatic timestamps (created_at/updated_at) work for create/append/prepend/write when timestamps flag is used. 7. All features have integration tests with real files.","status":"open","priority":2,"issue_type":"epic","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:24:40Z","created_by":"RamXX","updated_at":"2026-02-20T04:24:40Z","labels":["milestone"]}
{"id":"VLT-7fi","title":"Add inline code masking to inert zone infrastructure","description":"## User Story\nAs a vault user, I want wikilinks and tags inside inline code (`backtick spans`) to be ignored so that code references like `[[NotALink]]` or `#notATag` do not appear in my link graph or tag index.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. The walking skeleton story (VLT-0z7) introduced `maskInertContent()` in `inert.go` with support for fenced code blocks. This story extends the masking to **inline code spans** (single and double backticks).\n\n### How Inline Code Works in Obsidian/Markdown\n- Single backtick: `code here` -- everything between backticks is literal\n- Double backtick: ``code `with` backtick`` -- allows literal backticks inside\n- Backticks can appear mid-line: text `code` more text\n- Multiple inline code spans per line are possible\n- Inline code does NOT span multiple lines (unlike fenced blocks)\n\n### Implementation\nIn `inert.go`, add a new masking pass for inline code AFTER the fenced code block pass (order matters -- fenced blocks are already masked, so backticks inside them will not trigger inline code detection).\n\nRegex pattern: `` (`{1,2})([^`].*?)\\1 `` -- match opening backtick(s), capture content, match closing backtick(s) of same length. Mask the content (group 2) but preserve the backtick delimiters.\n\n**Important ordering**: Fenced code blocks MUST be masked first. Otherwise, triple backticks (```) could be misinterpreted as nested inline code.\n\n### Files to Modify\n- `inert.go` -- add inline code masking pass to maskInertContent()\n- `inert_test.go` -- add tests\n\nNo changes needed to wikilinks.go, tags.go, or commands.go -- they already call maskInertContent() via the walking skeleton.\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestMaskInlineCode` -- basic `code` span is masked\n2. `TestMaskDoubleBacktickCode` -- ``code`` span is masked\n3. `TestMaskMultipleInlineCodePerLine` -- `a` text `b` -- both masked\n4. `TestMaskInlineCodePreservesLength` -- output length equals input length\n5. `TestMaskInlineCodeNotInFencedBlock` -- inline backticks inside already-masked fenced blocks are not double-processed\n\n### Integration Tests (real files, no mocks)\n6. `TestParseWikilinksIgnoresInlineCode` -- parseWikilinks() returns NO links from `[[Link]]` in inline code\n7. `TestParseInlineTagsIgnoresInlineCode` -- parseInlineTags() returns NO tags from `#tag` in inline code\n8. `TestFindBacklinksIgnoresInlineCode` -- real vault (t.TempDir()), note with `[[Target]]` in inline code. findBacklinks() must NOT find it.\n9. `TestMixedFencedAndInlineCode` -- real vault with both fenced and inline code containing links/tags. Only non-code references are detected.\n\n## Acceptance Criteria\n1. Inline code spans (single backtick) are masked by maskInertContent()\n2. Double-backtick inline code spans are masked\n3. Fenced code block masking still works (no regression)\n4. parseWikilinks() ignores links in inline code\n5. parseInlineTags() ignores tags in inline code\n6. findBacklinks() ignores links in inline code\n7. All existing tests pass (zero regressions)\n8. 9+ new tests, all passing\n9. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go patterns, regex. No specialized skill requirements.","acceptance_criteria":"1. Inline code spans (single and double backtick) are masked\n2. Fenced block masking still works (no regression)\n3. All consumer functions ignore links/tags in inline code\n4. All existing tests pass\n5. 9+ new tests passing\n6. Zero external dependencies","notes":"## Delivery Proof\n\n### Implementation\n- Added `maskInlineCode()` as a registered mask pass in `inert.go`\n- Two regex patterns: `doubleBacktickPattern` and `singleBacktickPattern`\n- Double backticks processed first to avoid partial matches\n- Registered via `init()` as second pass after fenced code blocks\n\n### Test Results (93/93 pass, 0 regressions)\n```\nPASS\nok  github.com/RamXX/vlt  0.281s\n```\n\n### New Tests (9 total)\n**Unit tests (5):**\n1. TestMaskInlineCode -- basic single-backtick span is masked\n2. TestMaskDoubleBacktickCode -- double-backtick span is masked\n3. TestMaskMultipleInlineCodePerLine -- multiple spans on one line\n4. TestMaskInlineCodePreservesLength -- output length == input length (5 subtests)\n5. TestMaskInlineCodeNotInFencedBlock -- no double-processing with fenced blocks\n\n**Integration tests (4, no mocks):**\n6. TestParseWikilinksIgnoresInlineCode -- parseWikilinks returns no links from inline code\n7. TestParseInlineTagsIgnoresInlineCode -- parseInlineTags returns no tags from inline code\n8. TestFindBacklinksIgnoresInlineCode -- real vault, findBacklinks ignores inline code links\n9. TestMixedFencedAndInlineCode -- real vault, both fenced and inline code with links/tags\n\n### AC Verification\n| AC | Status | Evidence |\n|----|--------|----------|\n| 1. Inline code spans (single backtick) masked | PASS | TestMaskInlineCode |\n| 2. Double-backtick inline code spans masked | PASS | TestMaskDoubleBacktickCode |\n| 3. Fenced code block masking still works | PASS | All 12 existing fenced tests pass |\n| 4. parseWikilinks ignores inline code | PASS | TestParseWikilinksIgnoresInlineCode |\n| 5. parseInlineTags ignores inline code | PASS | TestParseInlineTagsIgnoresInlineCode |\n| 6. findBacklinks ignores inline code | PASS | TestFindBacklinksIgnoresInlineCode |\n| 7. All existing tests pass | PASS | 84 pre-existing + 9 new = 93 total |\n| 8. 9+ new tests | PASS | 9 new test functions |\n| 9. Zero external dependencies | PASS | go.mod has no require directives |\n\n### Files Modified\n- tools/vlt/inert.go (35 lines added)\n- tools/vlt/inert_test.go (291 lines added)\n\n### Commit\n9d2b06d feat(vlt): add inline code masking to inert zone infrastructure (VLT-7fi)","status":"closed","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:22:41Z","created_by":"RamXX","updated_at":"2026-02-20T05:06:04Z","closed_at":"2026-02-20T05:06:04Z","close_reason":"Accepted: inline code masking implemented via maskInlineCode() with correct double-then-single-backtick ordering; all 9 new tests pass (5 unit + 4 integration, no mocks); full suite 134 tests pass with zero regressions; zero external dependencies confirmed.","labels":["2sp","accepted"],"dependencies":[{"issue_id":"VLT-7fi","depends_on_id":"VLT-0s5","type":"parent-child","created_at":"2026-02-19T20:22:47Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-7fi","depends_on_id":"VLT-0z7","type":"blocks","created_at":"2026-02-19T20:22:47Z","created_by":"RamXX","metadata":"{}"}]}
{"id":"VLT-8gv","title":"Add obsidian:// URI generation for notes","description":"## User Story\nAs a vault user, I want to generate obsidian:// URIs for notes so that I can create clickable links in other tools (terminals, scripts, documentation) that open notes directly in Obsidian.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. Obsidian supports a custom URI scheme that can open notes directly: `obsidian://open?vault=VaultName\u0026file=path/to/Note`. This story adds a `uri` command that generates these URIs.\n\n### Obsidian URI Format\nThe standard Obsidian URI for opening a note is:\n```\nobsidian://open?vault=VAULT_NAME\u0026file=RELATIVE_PATH_WITHOUT_EXTENSION\n```\n\nKey rules:\n- Vault name is URL-encoded\n- File path is relative to vault root, WITHOUT the .md extension\n- File path is URL-encoded (spaces become %20, etc.)\n- Path separator is / (forward slash, even on Windows)\n- Heading links: `obsidian://open?vault=X\u0026file=Y\u0026heading=H`\n- Block links: `obsidian://open?vault=X\u0026file=Y\u0026block=B`\n\n### Behavior\n`vlt vault=\"Claude\" uri file=\"Session Operating Mode\"` outputs:\n```\nobsidian://open?vault=Claude\u0026file=methodology%2FSession%20Operating%20Mode\n```\n\nThe command resolves the note by title (using resolveNote), gets the relative path, strips .md, URL-encodes, and constructs the URI.\n\nOptional parameters:\n- `heading=\"Section\"` -- adds \u0026heading=Section to the URI\n- `block=\"block-id\"` -- adds \u0026block=block-id to the URI\n\n### Implementation\nAdd `cmdURI()` to `commands.go`:\n1. Resolve note by title\n2. Get relative path from vault root\n3. Strip .md extension\n4. URL-encode vault name and file path using `net/url.PathEscape()` (stdlib)\n5. Construct and print the URI\n\n### Files to Modify\n- `commands.go` -- add `cmdURI()` function\n- `main.go` -- add \"uri\" to knownCommands, dispatch, usage text\n- Test file -- add tests\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestURIBasic` -- simple note generates correct URI\n2. `TestURIWithSpaces` -- note with spaces in path is URL-encoded\n3. `TestURIWithSubfolder` -- note in subfolder has correct path\n4. `TestURIWithHeading` -- heading parameter adds \u0026heading=\n5. `TestURIWithBlock` -- block parameter adds \u0026block=\n6. `TestURISpecialCharacters` -- special characters in vault name and path are encoded\n7. `TestURIRequiresFile` -- error without file= parameter\n\n### Integration Tests (real files, no mocks)\n8. `TestURIIntegration` -- create vault in t.TempDir(), create note, generate URI, verify format\n9. `TestURISubfolderIntegration` -- note in subfolder, verify correct relative path in URI\n10. `TestURINoteNotFound` -- nonexistent note returns error\n\n## Acceptance Criteria\n1. `uri file=\"X\"` generates `obsidian://open?vault=V\u0026file=P` URI\n2. Vault name URL-encoded\n3. File path URL-encoded, .md stripped, relative to vault root\n4. heading= parameter supported\n5. block= parameter supported\n6. Error on nonexistent note\n7. \"uri\" in help text\n8. All existing tests pass\n9. 10+ new tests, all passing\n10. Zero external dependencies (net/url is stdlib)\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go net/url package. No specialized skill requirements.","acceptance_criteria":"1. uri command generates correct obsidian:// URI\n2. URL encoding correct\n3. heading= and block= supported\n4. Error on not found\n5. All existing tests pass\n6. 10+ new tests passing","status":"open","priority":1,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:29:10Z","created_by":"RamXX","updated_at":"2026-02-20T04:29:10Z","labels":["1sp"],"dependencies":[{"issue_id":"VLT-8gv","depends_on_id":"VLT-p02","type":"parent-child","created_at":"2026-02-19T20:29:14Z","created_by":"RamXX","metadata":"{}"}]}
{"id":"VLT-9ps","title":"Add write command to overwrite note body content","description":"## User Story\nAs a vault user, I want to overwrite the body content of an existing note while preserving its frontmatter, so that I can programmatically update note content without manual editing.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. Currently vlt supports `create` (new notes), `append` (add to end), and `prepend` (add after frontmatter), but there is NO way to REPLACE the body content of an existing note. The official Obsidian CLI has a `write` command for this purpose.\n\n### Behavior\n- `vlt vault=\"X\" write file=\"Note\" content=\"new body\"` -- replaces the entire body of \"Note\" with \"new body\"\n- Content from stdin if content= not provided (same pattern as append/prepend)\n- **Frontmatter is preserved**: only the body (everything after the closing `---`) is replaced\n- If the note has no frontmatter, the entire file content is replaced\n- The note must already exist (unlike create). Returns error if note not found.\n\n### Implementation\nAdd `cmdWrite()` to `commands.go` following the same pattern as `cmdAppend()` and `cmdPrepend()`:\n1. Resolve note by title using `resolveNote()`\n2. Read existing content\n3. Extract frontmatter using `extractFrontmatter()`\n4. Rebuild file: frontmatter (if any) + new body content\n5. Write back to same path\n\nAdd \"write\" to `knownCommands` map and dispatch in `main.go`.\nAdd to usage text.\n\n### Files to Modify\n- `commands.go` -- add `cmdWrite()` function\n- `main.go` -- add \"write\" to knownCommands, add dispatch case, update usage text\n- `main_test.go` or `commands_test.go` -- add tests (use whichever file already has command tests)\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestCmdWriteReplacesBody` -- write to note with frontmatter, verify frontmatter preserved and body replaced\n2. `TestCmdWriteNoFrontmatter` -- write to note without frontmatter, verify entire content replaced\n3. `TestCmdWriteEmptyBody` -- write empty content, verify note becomes frontmatter-only\n4. `TestCmdWriteRequiresFile` -- write without file= returns error\n5. `TestCmdWriteNoteNotFound` -- write to nonexistent note returns error\n\n### Integration Tests (real files, no mocks)\n6. `TestWritePreservesFrontmatter` -- create real note with frontmatter + body in t.TempDir(), write new body, read back and verify frontmatter intact\n7. `TestWriteViaStdin` -- write content piped from stdin (test the stdin fallback path)\n8. `TestWriteThenRead` -- write content, then use cmdRead to verify the content round-trips correctly\n9. `TestWriteDoesNotCreateFile` -- write to nonexistent file returns error, file does not appear\n\n### E2E Test\n10. `TestE2EWriteCommand` -- create vault with t.TempDir(), create note with frontmatter and body, run cmdWrite with new content, verify with cmdRead that frontmatter is preserved and body is replaced, verify with cmdProperties that properties are intact.\n\n## Acceptance Criteria\n1. `vlt vault=\"X\" write file=\"Note\" content=\"...\"` replaces body content\n2. Frontmatter (--- ... ---) is preserved when present\n3. Notes without frontmatter have full content replaced\n4. Stdin fallback works when content= not provided\n5. Error returned for nonexistent notes\n6. \"write\" appears in help/usage text\n7. All existing tests pass\n8. 10+ new tests, all passing\n9. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go file I/O patterns. No specialized skill requirements.","acceptance_criteria":"1. write command replaces body content\n2. Frontmatter preserved\n3. Stdin fallback works\n4. Error on nonexistent note\n5. Added to help text\n6. All existing tests pass\n7. 10+ new tests passing","status":"closed","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:25:09Z","created_by":"RamXX","updated_at":"2026-02-20T04:58:40Z","closed_at":"2026-02-20T04:58:40Z","close_reason":"Accepted: write command implemented correctly. cmdWrite() in commands.go replaces body while preserving frontmatter. Fully dispatched in main.go. 10 new tests (5 unit, 4 integration, 1 E2E) all passing with real files, no mocks. Full suite green. All 7 ACs verified.","labels":["2sp","accepted"],"dependencies":[{"issue_id":"VLT-9ps","depends_on_id":"VLT-6z0","type":"parent-child","created_at":"2026-02-19T20:25:13Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":5,"issue_id":"VLT-9ps","author":"RamXX","text":"Delivery proof: commit 519ab24. 10 new tests (5 unit, 4 integration, 1 E2E), all passing. Full test suite green (0.408s). All 7 AC verified. Zero external dependencies.","created_at":"2026-02-20T04:54:45Z"}]}
{"id":"VLT-aca","title":"Add regex search support (search regex=\"pattern\")","description":"## User Story\nAs a vault user, I want to search my vault using regular expressions so that I can find content matching complex patterns beyond simple substring matching.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. Currently `vlt search query=\"term\"` performs a case-insensitive substring match only. This story adds regex search support using Go standard library regexp package.\n\n### Behavior\n`vlt vault=\"X\" search regex=\"arch\\w+ure\"` uses Go regexp to match note content.\n- If both query= and regex= are provided, regex= takes precedence (with a warning to stderr)\n- Invalid regex returns a clear error message: `invalid regex \"...\": \u003cerror\u003e`\n- Regex matching is case-insensitive by default (wraps pattern in (?i)...)\n- Property filters ([key:value]) still work with regex search\n- Title matching also uses regex (not just content)\n- When combined with context= (from sibling story), regex matches also show context lines\n\n### Implementation\nModify `cmdSearch()` in `commands.go`:\n1. Check for `regex` parameter\n2. If regex provided, compile with `regexp.Compile(\"(?i)\" + pattern)` for case-insensitive matching\n3. Use `regexp.MatchString()` for content matching instead of `strings.Contains()`\n4. Use `regexp.FindString()` for title matching instead of `strings.Contains()`\n5. Invalid regex: return error with the compilation error message\n6. Both query= and regex=: log warning, use regex\n\n### Files to Modify\n- `commands.go` -- modify `cmdSearch()` to support regex= parameter; add regex compilation and matching\n- `main.go` -- update usage text for search command\n- Test file -- add tests\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestSearchRegexBasic` -- regex search finds matches with pattern\n2. `TestSearchRegexInvalid` -- invalid regex returns clear error with message\n3. `TestSearchRegexCaseInsensitive` -- regex matching is case-insensitive by default\n4. `TestSearchRegexWithPropertyFilter` -- regex + [key:value] filter works together\n5. `TestSearchRegexAndQueryPrecedence` -- both provided: regex takes precedence\n6. `TestSearchRegexMatchesTitle` -- regex matches against note title too\n7. `TestSearchRegexNoMatch` -- regex with no matches returns empty/silent\n\n### Integration Tests (real files, no mocks)\n8. `TestSearchRegexIntegration` -- create notes in t.TempDir(), search with regex, verify correct matches returned\n9. `TestSearchRegexComplexPattern` -- test with a complex regex (e.g., date pattern \\d{4}-\\d{2}-\\d{2})\n10. `TestSearchRegexWithContext` -- regex search combined with context= parameter (if context story is complete; if not, test that regex works standalone)\n\n## Acceptance Criteria\n1. `search regex=\"pattern\"` uses Go regexp for matching\n2. Invalid regex returns clear error with compilation message\n3. Case-insensitive by default\n4. Property filters work with regex\n5. Both query= and regex= provided: regex takes precedence\n6. Regex matches both title and content\n7. Existing search behavior unchanged when regex= not provided\n8. All existing tests pass\n9. 10+ new tests, all passing\n10. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go regexp package. No specialized skill requirements.","acceptance_criteria":"1. search regex= uses Go regexp\n2. Invalid regex returns clear error\n3. Case-insensitive by default\n4. Property filters work with regex\n5. Backward compatible\n6. All existing tests pass\n7. 10+ new tests passing","status":"closed","priority":3,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:36:17Z","created_by":"RamXX","updated_at":"2026-02-20T05:46:02Z","closed_at":"2026-02-20T05:46:02Z","close_reason":"Accepted: regex search fully implemented. All 7 ACs verified: regexp.Compile with (?i) prefix, clear error on invalid pattern, case-insensitive by default, property filters work with regex, backward compatible with query= mode. 13 new tests (exceeds 10 minimum), all passing. 231 total tests pass, 0 failures. Zero external dependencies added.","labels":["3sp","accepted"],"dependencies":[{"issue_id":"VLT-aca","depends_on_id":"VLT-6z0","type":"parent-child","created_at":"2026-02-19T20:36:24Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":12,"issue_id":"VLT-aca","author":"RamXX","text":"Delivery proof: commit 2665a9d. 217 tests PASS, 0 FAIL. 13 new regex tests. All 7 ACs verified. See commit message for details.","created_at":"2026-02-20T05:42:17Z"}]}
{"id":"VLT-anb","title":"Add bookmarks management (list, add, remove) via .obsidian/bookmarks.json","description":"## User Story\nAs a vault user, I want to list, add, and remove Obsidian bookmarks from the command line so that I can manage my bookmarked notes without opening Obsidian.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. Obsidian stores bookmarks in `.obsidian/bookmarks.json` as a JSON array of bookmark objects. This file is accessible on the filesystem and can be read/written without the Obsidian app running.\n\n### Obsidian Bookmarks Format\n`.obsidian/bookmarks.json` structure:\n```json\n{\n  \"items\": [\n    {\n      \"type\": \"file\",\n      \"ctime\": 1708300000000,\n      \"path\": \"folder/My Note.md\",\n      \"title\": \"\"\n    },\n    {\n      \"type\": \"group\",\n      \"ctime\": 1708300000001,\n      \"title\": \"My Group\",\n      \"items\": [\n        {\n          \"type\": \"file\",\n          \"ctime\": 1708300000002,\n          \"path\": \"other/Note.md\",\n          \"title\": \"\"\n        }\n      ]\n    }\n  ]\n}\n```\n\nBookmark types include: `file`, `folder`, `group`, `search`, `graph`. For this story, focus on `file` type bookmarks (the most common). Groups contain nested items.\n\n### Behavior\n\n**List bookmarks:**\n`vlt vault=\"X\" bookmarks` -- lists all bookmarked file paths\n`vlt vault=\"X\" bookmarks --json` -- JSON output\nOutput: flat list of paths (recursing into groups)\n\n**Add bookmark:**\n`vlt vault=\"X\" bookmarks:add file=\"My Note\"` -- adds a bookmark for the note\n- Resolves note title to path using resolveNote()\n- Adds to the top-level items array\n- Sets ctime to current Unix timestamp in milliseconds\n- Does not add duplicates (checks if path already bookmarked)\n\n**Remove bookmark:**\n`vlt vault=\"X\" bookmarks:remove file=\"My Note\"` -- removes the bookmark\n- Resolves note title to path\n- Removes from items array (including searching within groups)\n\n### Implementation\n- New: `bookmarks.go` -- bookmark types, load/save/list/add/remove functions\n- New: `bookmarks_test.go` -- tests\n- `main.go` -- add bookmarks, bookmarks:add, bookmarks:remove to knownCommands, dispatch, usage\n\n### Files to Modify\n- NEW: `bookmarks.go`\n- NEW: `bookmarks_test.go`\n- `main.go` -- add commands, dispatch, usage text\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestLoadBookmarks` -- parse bookmarks.json correctly\n2. `TestLoadBookmarksEmpty` -- handle empty/missing file gracefully\n3. `TestLoadBookmarksNested` -- parse groups with nested items\n4. `TestFlattenBookmarks` -- flatten nested groups into flat path list\n5. `TestAddBookmark` -- add new bookmark to items array\n6. `TestAddBookmarkNoDuplicate` -- adding existing bookmark is a no-op\n7. `TestRemoveBookmark` -- remove bookmark from items\n8. `TestRemoveBookmarkFromGroup` -- remove bookmark nested inside a group\n9. `TestRemoveBookmarkNotFound` -- error when removing non-bookmarked note\n\n### Integration Tests (real files, no mocks)\n10. `TestBookmarksListIntegration` -- create .obsidian/bookmarks.json in t.TempDir(), list bookmarks, verify output\n11. `TestBookmarksAddIntegration` -- create vault, add bookmark, re-read file, verify it was added\n12. `TestBookmarksRemoveIntegration` -- create vault with bookmarks, remove one, verify file updated\n13. `TestBookmarksAddResolvesTitle` -- add bookmark by note title, verify path stored correctly\n14. `TestBookmarksWithFormats` -- verify --json, --csv, --yaml, --tsv output for bookmarks list\n\n## Acceptance Criteria\n1. `bookmarks` lists all bookmarked file paths (flat, recursing groups)\n2. `bookmarks:add file=\"X\"` adds a bookmark (resolves title to path)\n3. `bookmarks:remove file=\"X\"` removes a bookmark\n4. No duplicate bookmarks added\n5. Error on removing non-bookmarked note\n6. All output formats supported (json, csv, yaml, tsv)\n7. .obsidian/bookmarks.json created if it does not exist (for add)\n8. All existing tests pass\n9. 14+ new tests, all passing\n10. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go JSON encoding, file I/O. No specialized skill requirements.","acceptance_criteria":"1. bookmarks lists paths (flat, recursing groups)\n2. bookmarks:add adds bookmark (resolves title to path)\n3. bookmarks:remove removes bookmark\n4. No duplicates\n5. All output formats work (json, csv, yaml, tsv)\n6. If .obsidian/ directory does not exist, create it along with bookmarks.json on add\n7. bookmarks list returns empty (not error) if .obsidian/bookmarks.json does not exist\n8. All existing tests pass\n9. 14+ new tests passing","status":"open","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:28:19Z","created_by":"RamXX","updated_at":"2026-02-20T04:38:41Z","labels":["3sp"],"dependencies":[{"issue_id":"VLT-anb","depends_on_id":"VLT-0e0","type":"blocks","created_at":"2026-02-19T20:35:21Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-anb","depends_on_id":"VLT-p02","type":"parent-child","created_at":"2026-02-19T20:28:22Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":3,"issue_id":"VLT-anb","author":"RamXX","text":"C11 NOTE -- .obsidian directory absence handling: When bookmarks:add is called and neither .obsidian/ nor bookmarks.json exist, create both. When bookmarks (list) is called and .obsidian/bookmarks.json does not exist, return an empty list (not an error). When bookmarks:remove is called and bookmarks.json does not exist, return an error (nothing to remove). Add integration tests: TestBookmarksAddCreatesObsidianDir (vault with no .obsidian/ directory, add bookmark, verify .obsidian/bookmarks.json created), TestBookmarksListNoObsidianDir (vault with no .obsidian/, list returns empty).","created_at":"2026-02-20T04:38:48Z"}]}
{"id":"VLT-g6l","title":"Add template listing and application with variable substitution","description":"## User Story\nAs a vault user, I want to list available templates and apply them to new notes with variable substitution, so that I can use my Obsidian templates from the command line.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. Obsidian templates are just markdown files in a configured folder. The template folder location is stored in `.obsidian/core-plugins.json` (if the core Templates plugin is enabled) and the folder name in `.obsidian/templates.json` or the app config. The daily notes command already does basic template variable substitution ({{date}}, {{title}}).\n\n### How Templates Work in Obsidian\n- Templates are regular .md files in a designated folder (default: \"templates/\")\n- Template folder configured in `.obsidian/templates.json`: `{\"folder\": \"templates\"}`\n- Or in `.obsidian/app.json` under templates settings\n- Variables: `{{date}}`, `{{time}}`, `{{title}}` are the core supported variables\n- `{{date:FORMAT}}` supports custom date formats (Moment.js format, e.g., `{{date:YYYY-MM-DD}}`)\n- `{{time:FORMAT}}` supports custom time formats (e.g., `{{time:HH:mm}}`)\n\n### Behavior\n\n**List templates:**\n`vlt vault=\"X\" templates` -- lists available template files\nOutput: relative paths of all .md files in the template folder\n\n**Apply template:**\n`vlt vault=\"X\" templates:apply template=\"Meeting Notes\" name=\"Q1 Planning\" path=\"meetings/Q1 Planning.md\"`\n- Reads the template file\n- Substitutes variables:\n  - `{{title}}` -\u003e the name parameter\n  - `{{date}}` -\u003e today in YYYY-MM-DD format\n  - `{{time}}` -\u003e current time in HH:MM format\n  - `{{date:FORMAT}}` -\u003e today in specified format (translated via momentToGoFormat from daily.go)\n  - `{{time:FORMAT}}` -\u003e current time in specified format\n- Creates the new note at the specified path with the substituted content\n- Error if template not found, error if target note already exists\n\n### Implementation\n- New: `templates.go` -- template folder discovery, listing, variable substitution, application\n- New: `templates_test.go` -- tests\n- `main.go` -- add templates, templates:apply to knownCommands, dispatch, usage\n- Reuse `momentToGoFormat()` from `daily.go` for date/time format conversion\n\n### Files to Modify\n- NEW: `templates.go`\n- NEW: `templates_test.go`\n- `main.go` -- add commands, dispatch, usage text\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestDiscoverTemplateFolder` -- reads template folder from .obsidian/templates.json\n2. `TestDiscoverTemplateFolderDefault` -- defaults to \"templates\" if no config\n3. `TestTemplateVariableSubstitution` -- {{title}}, {{date}}, {{time}} replaced\n4. `TestTemplateCustomDateFormat` -- {{date:YYYY-MM-DD}} uses custom format\n5. `TestTemplateCustomTimeFormat` -- {{time:HH:mm}} uses custom format\n6. `TestTemplateNoVariables` -- template without variables copied as-is\n7. `TestTemplateUnknownVariable` -- unknown {{foo}} left as-is (not an error)\n\n### Integration Tests (real files, no mocks)\n8. `TestTemplatesListIntegration` -- create vault with template folder in t.TempDir(), list templates, verify output\n9. `TestTemplatesApplyIntegration` -- apply template, read resulting note, verify variables substituted\n10. `TestTemplatesApplyExistingNote` -- apply to existing path returns error\n11. `TestTemplatesApplyNotFound` -- apply nonexistent template returns error\n12. `TestTemplatesApplyCreatesDirectories` -- target path in nonexistent directory, directories auto-created\n13. `TestTemplatesWithFormats` -- list templates with --json, --csv output formats\n\n## Acceptance Criteria\n1. `templates` lists .md files in configured template folder\n2. `templates:apply` creates new note from template with variable substitution\n3. {{title}}, {{date}}, {{time}} substituted\n4. {{date:FORMAT}} and {{time:FORMAT}} with custom formats work\n5. Error on nonexistent template\n6. Error on existing target note\n7. Template folder discovered from .obsidian/templates.json\n8. Falls back to \"templates/\" default folder\n9. All output formats supported for list\n10. All existing tests pass\n11. 13+ new tests, all passing\n12. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go time formatting, file I/O, JSON parsing. No specialized skill requirements.","acceptance_criteria":"1. templates lists .md files in configured template folder\n2. templates:apply creates note from template with variable substitution\n3. Variable substitution works ({{title}}, {{date}}, {{time}})\n4. Custom date/time formats work ({{date:FORMAT}}, {{time:FORMAT}})\n5. Error on nonexistent template\n6. Error on existing target note\n7. If no template folder found (no .obsidian/templates.json config AND no default templates/ folder exists), return clear error: \"no template folder configured or found\"\n8. Template folder discovered from .obsidian/templates.json\n9. Falls back to templates/ default folder if config absent but folder exists\n10. All output formats supported for list\n11. All existing tests pass\n12. 14+ new tests passing (including TestTemplatesNoFolderError)","status":"open","priority":3,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:28:46Z","created_by":"RamXX","updated_at":"2026-02-20T04:39:01Z","labels":["3sp"],"dependencies":[{"issue_id":"VLT-g6l","depends_on_id":"VLT-0e0","type":"blocks","created_at":"2026-02-19T20:35:22Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-g6l","depends_on_id":"VLT-p02","type":"parent-child","created_at":"2026-02-19T20:28:50Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":4,"issue_id":"VLT-g6l","author":"RamXX","text":"C12 NOTE -- Absent template folder handling: If .obsidian/templates.json does not exist AND the default 'templates/' folder does not exist in the vault root, return a clear error: 'no template folder configured or found'. Do NOT silently return an empty list. The error should guide the user to either create a templates/ folder or configure it in Obsidian. Add test: TestTemplatesNoFolderError (vault with no .obsidian/templates.json and no templates/ directory, verify error returned with clear message).","created_at":"2026-02-20T04:39:07Z"}]}
{"id":"VLT-h6k","title":"Add HTML comment masking (\u003c!-- ... --\u003e) to inert zone infrastructure","description":"## User Story\nAs a vault user, I want wikilinks and tags inside HTML comments (\u003c!-- ... --\u003e) to be ignored so that commented-out HTML content does not pollute my link graph or tag index.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. The walking skeleton story (VLT-0z7) introduced `maskInertContent()` in `inert.go`. This story extends the masking to **HTML comments**.\n\n### How HTML Comments Work in Obsidian\n- Standard HTML comment syntax: `\u003c!-- content --\u003e`\n- Can be inline: `text \u003c!-- hidden --\u003e more text`\n- Can span multiple lines:\n  ```\n  \u003c!--\n  This whole block\n  is hidden\n  --\u003e\n  ```\n- Obsidian renders these as invisible in preview mode\n- Content inside should NOT be parsed for links or tags\n- HTML comments are different from Obsidian comments (%% ... %%)\n\n### Implementation\nIn `inert.go`, add a masking pass for HTML comments. This should run AFTER fenced code block, inline code, and Obsidian comment masking (so \u003c!-- inside code or %% comments is already masked).\n\nRegex pattern: `\u003c!--[\\s\\S]*?--\u003e` -- match opening \u003c!--, content (including newlines), closing --\u003e. Mask everything between the delimiters (preserve \u003c!-- and --\u003e themselves for debugging).\n\n### Files to Modify\n- `inert.go` -- add HTML comment masking pass to maskInertContent()\n- `inert_test.go` -- add tests\n\nNo changes to consumer files needed.\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestMaskHTMLCommentInline` -- `text \u003c!-- hidden --\u003e more` masks the hidden part\n2. `TestMaskHTMLCommentMultiline` -- multiline \u003c!-- block is fully masked\n3. `TestMaskHTMLCommentPreservesLength` -- output length equals input length\n4. `TestMaskMultipleHTMLComments` -- multiple comments in one document\n5. `TestMaskHTMLCommentInsideFencedBlock` -- \u003c!-- inside a code block is NOT treated as comment (already masked)\n\n### Integration Tests (real files, no mocks)\n6. `TestParseWikilinksIgnoresHTMLComments` -- parseWikilinks() ignores [[Link]] inside \u003c!-- --\u003e\n7. `TestParseInlineTagsIgnoresHTMLComments` -- parseInlineTags() ignores #tag inside \u003c!-- --\u003e\n8. `TestFindBacklinksIgnoresHTMLComments` -- real vault: note with [[B]] inside \u003c!-- --\u003e. findBacklinks() returns empty.\n9. `TestMixedAllCommentTypes` -- vault with links in code, %% comments, and HTML comments. Only plain-text links detected.\n\n## Acceptance Criteria\n1. Inline HTML comments (\u003c!-- ... --\u003e) are masked\n2. Multiline HTML comments are masked\n3. \u003c!-- inside already-masked zones do not trigger false boundaries\n4. parseWikilinks() ignores links in HTML comments\n5. parseInlineTags() ignores tags in HTML comments\n6. findBacklinks() ignores links in HTML comments\n7. All existing tests pass\n8. 9+ new tests, all passing\n9. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go patterns, regex. No specialized skill requirements.","acceptance_criteria":"1. HTML comments (\u003c!-- ... --\u003e) are masked (inline and multiline)\n2. \u003c!-- inside code blocks does not trigger comment masking\n3. All consumer functions ignore links/tags in HTML comments\n4. All existing tests pass\n5. 9+ new tests passing\n6. Zero external dependencies","status":"closed","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:23:23Z","created_by":"RamXX","updated_at":"2026-02-20T05:13:49Z","closed_at":"2026-02-20T05:13:49Z","close_reason":"Accepted: HTML comment masking fully implemented. maskHTMLComments() added to inert.go with correct (?s)\u003c!--(.*?)--\u003e pattern, registered in the right pipeline position (after fenced code, inline code, and Obsidian comments). All 5 ACs verified: inline and multiline masking work, ordering prevents false boundaries inside code blocks, parseWikilinks/parseInlineTags/findBacklinks all ignore HTML comment content. 9 new test functions (15 subtests) pass, no mocks in integration tests, zero external dependencies.","labels":["2sp","accepted"],"dependencies":[{"issue_id":"VLT-h6k","depends_on_id":"VLT-0s5","type":"parent-child","created_at":"2026-02-19T20:23:26Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-h6k","depends_on_id":"VLT-0z7","type":"blocks","created_at":"2026-02-19T20:23:26Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":7,"issue_id":"VLT-h6k","author":"RamXX","text":"## Delivery Proof -- VLT-h6k\n\n### Files Modified\n- `tools/vlt/inert.go` -- Added `htmlCommentPattern`, `maskHTMLComments()`, and registered pass in `init()`\n- `tools/vlt/inert_test.go` -- Added 9 new test functions (5 unit + 4 integration)\n\n### Commit\na234058 feat: add HTML comment masking (\u003c!-- ... --\u003e) to inert zone infrastructure\n\n### CI Results (all tests passing)\n```\nok  github.com/RamXX/vlt  0.365s\n```\n- Total tests: 100+ (all pass)\n- New tests: 9 functions (with subtests: 15 total assertions)\n- go vet: clean\n\n### New Tests Added\n**Unit tests (5):**\n1. TestMaskHTMLCommentInline -- inline \u003c!-- hidden --\u003e is masked\n2. TestMaskHTMLCommentMultiline -- multiline \u003c!-- block is fully masked, newlines preserved\n3. TestMaskHTMLCommentPreservesLength -- 6 subtests confirming byte-length invariant\n4. TestMaskMultipleHTMLComments -- multiple comments in one document\n5. TestMaskHTMLCommentInsideFencedBlock -- \u003c!-- inside code block does NOT start comment\n\n**Integration tests (4, no mocks, real files via t.TempDir()):**\n6. TestParseWikilinksIgnoresHTMLComments -- parseWikilinks() ignores [[Link]] inside \u003c!-- --\u003e\n7. TestParseInlineTagsIgnoresHTMLComments -- parseInlineTags() ignores #tag inside \u003c!-- --\u003e\n8. TestFindBacklinksIgnoresHTMLComments -- real vault: note with [[B]] inside \u003c!-- --\u003e, findBacklinks returns empty\n9. TestMixedAllCommentTypes -- vault with links in code, inline code, %% comments, AND HTML comments; only plain-text links detected\n\n### AC Verification\n\n| # | Criterion | Status | Evidence |\n|---|-----------|--------|----------|\n| 1 | Inline HTML comments masked | PASS | TestMaskHTMLCommentInline |\n| 2 | Multiline HTML comments masked | PASS | TestMaskHTMLCommentMultiline |\n| 3 | \u003c!-- inside code blocks does not trigger | PASS | TestMaskHTMLCommentInsideFencedBlock |\n| 4 | parseWikilinks() ignores links in HTML comments | PASS | TestParseWikilinksIgnoresHTMLComments |\n| 5 | parseInlineTags() ignores tags in HTML comments | PASS | TestParseInlineTagsIgnoresHTMLComments |\n| 6 | findBacklinks() ignores links in HTML comments | PASS | TestFindBacklinksIgnoresHTMLComments |\n| 7 | All existing tests pass | PASS | Full test suite: ok github.com/RamXX/vlt 0.365s |\n| 8 | 9+ new tests, all passing | PASS | 9 test functions (15 subtests) |\n| 9 | Zero external dependencies | PASS | stdlib only (regexp) |","created_at":"2026-02-20T05:10:39Z"}]}
{"id":"VLT-hha","title":"Add search context lines (grep -C style)","description":"## User Story\nAs a vault user, I want to see surrounding content lines in search results so that I can understand matches in context without opening each file.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. Currently `vlt search query=\"term\"` performs a case-insensitive substring match and returns title + path only. There is no way to see WHERE in the file the match occurs or what surrounds it. This story adds context line support, similar to `grep -C`.\n\n### Behavior\n`vlt vault=\"X\" search query=\"architecture\" context=\"2\"` returns:\n```\ndecisions/ADR-001.md:15: The previous approach used...\ndecisions/ADR-001.md:16: After reviewing the options,\ndecisions/ADR-001.md:17: **architecture** decision was made  \u003c-- match\ndecisions/ADR-001.md:18: to use a layered pattern\ndecisions/ADR-001.md:19: with clear boundaries.\n```\n\nWhen context= is provided, output format changes from title+path to file:line:content format (similar to grep). Context lines have no special marker; the match line is included in the range.\n\nWith --json format, context output includes: `{\"file\": \"path\", \"line\": 17, \"match\": \"...\", \"context\": [\"line before\", \"line before\", \"match line\", \"line after\", \"line after\"]}`.\n\nWhen context= is NOT provided, existing behavior is unchanged (title + path only).\n\nMultiple matches in the same file with overlapping context ranges are merged into a single continuous block.\n\n### Implementation\nModify `cmdSearch()` in `commands.go`:\n1. Check for optional `context` parameter, parse as integer\n2. When context is provided, after finding a matching file, track line numbers of matches\n3. For each match, collect N lines before and after\n4. Merge overlapping context ranges\n5. Output in file:line:content format\n\nAdd new format function in `format.go`:\n- `formatSearchWithContext()` for context-aware output in all formats (plain, json, csv, yaml)\n- JSON format: array of `{\"file\": \"...\", \"line\": N, \"match\": \"...\", \"context\": [\"...\"]}` objects\n- CSV format: file,line,content columns\n- YAML format: structured entries\n\n### Files to Modify\n- `commands.go` -- modify `cmdSearch()` to support context= parameter; add line-level matching logic\n- `format.go` -- add `formatSearchWithContext()` for context-aware output in all formats\n- `main.go` -- update usage text for search command\n- Test file -- add tests\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestSearchContextBasic` -- search with context=1 shows 1 line before and after\n2. `TestSearchContextAtFileStart` -- match on line 1, no lines before (no error/panic)\n3. `TestSearchContextAtFileEnd` -- match on last line, no lines after\n4. `TestSearchContextMultipleMatches` -- multiple matches with overlapping context are merged\n5. `TestSearchContextZero` -- context=0 shows only the match line with file:line:content format\n6. `TestSearchQueryUnchangedWithoutContext` -- existing query= behavior unchanged when no context used\n\n### Integration Tests (real files, no mocks)\n7. `TestSearchContextIntegration` -- create notes in t.TempDir(), search with context, verify output includes surrounding lines\n8. `TestSearchContextWithJSONFormat` -- verify --json output includes context array structure\n9. `TestSearchContextWithCSVFormat` -- verify --csv output has file,line,content columns\n10. `TestSearchContextWithPropertyFilter` -- context works alongside [key:value] property filters\n\n## Acceptance Criteria\n1. `search query=\"X\" context=\"N\"` shows N lines before/after each match\n2. Context output uses file:line:content format (plain text)\n3. --json, --csv, --yaml formats support context output with structured data\n4. Overlapping context ranges merged\n5. Existing search behavior unchanged when context= not provided\n6. All existing tests pass\n7. 10+ new tests, all passing\n8. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go string/line manipulation. No specialized skill requirements.","acceptance_criteria":"1. search context=N shows surrounding lines\n2. Context output uses file:line:content format\n3. All output formats support context\n4. Overlapping ranges merged\n5. Backward compatible\n6. All existing tests pass\n7. 10+ new tests passing","status":"closed","priority":3,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:36:00Z","created_by":"RamXX","updated_at":"2026-02-20T05:34:56Z","closed_at":"2026-02-20T05:34:56Z","close_reason":"Accepted: Search context lines (grep -C style) fully implemented. 12 new tests (all passing), file:line:content format verified, all output formats (JSON/CSV/YAML/plain) support context, overlapping ranges merged, backward compatible, zero external dependencies. Coverage 76.6%.","labels":["3sp","accepted"],"dependencies":[{"issue_id":"VLT-hha","depends_on_id":"VLT-6z0","type":"parent-child","created_at":"2026-02-19T20:36:23Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":11,"issue_id":"VLT-hha","author":"RamXX","text":"## Delivery Proof -- VLT-hha: Search Context Lines\n\n### CI Results (all tests passing)\n```\ngo test -count=1 -cover ./...\nok  github.com/RamXX/vlt  0.398s  coverage: 76.6% of statements\n```\n\n### New Tests (12 total, all passing)\n1. TestSearchContextBasic -- context=1 shows 1 line before/after\n2. TestSearchContextAtFileStart -- match on line 1, no panic\n3. TestSearchContextAtFileEnd -- match on last line, no crash\n4. TestSearchContextMultipleMatches -- overlapping ranges merged\n5. TestSearchContextZero -- context=0 shows match line only\n6. TestSearchQueryUnchangedWithoutContext -- backward compatibility\n7. TestSearchContextIntegration -- real vault files, full flow\n8. TestSearchContextWithJSONFormat -- JSON output structure verified\n9. TestSearchContextWithCSVFormat -- CSV header + data verified\n10. TestSearchContextWithPropertyFilter -- context + [key:value] filter\n11. TestSearchContextTitleMatch -- title-only match in context mode\n12. TestSearchContextWithYAMLFormat -- YAML structured output verified\n\n### AC Verification Table\n| AC | Status | Evidence |\n|---|---|---|\n| 1. search context=N shows surrounding lines | PASS | TestSearchContextBasic, TestSearchContextAtFileStart, TestSearchContextAtFileEnd |\n| 2. Context output uses file:line:content format | PASS | TestSearchContextZero (verifies Zero.md:2: format) |\n| 3. All output formats support context | PASS | JSON, CSV, YAML tests all pass |\n| 4. Overlapping ranges merged | PASS | TestSearchContextMultipleMatches (middle appears once) |\n| 5. Backward compatible | PASS | TestSearchQueryUnchangedWithoutContext |\n| 6. All existing tests pass | PASS | go test ./... all green |\n| 7. 10+ new tests passing | PASS | 12 new tests, all passing |\n\n### Files Modified\n- commands.go: contextMatch struct, findMatchLines, expandAndMerge, parseInt0, modified cmdSearch\n- format.go: formatSearchWithContext for all output formats (plain, json, csv, yaml)\n- main.go: Updated usage text with context parameter and examples\n- main_test.go: 12 new test functions\n\n### Zero external dependencies confirmed\ngo list -m all returns only github.com/RamXX/vlt\n\n### Commit: 2926309\n","created_at":"2026-02-20T05:31:44Z"}]}
{"id":"VLT-i6l","title":"Add Obsidian comment masking (%% ... %%) to inert zone infrastructure","description":"## User Story\nAs a vault user, I want wikilinks and tags inside Obsidian comments (%% ... %%) to be ignored so that commented-out references do not appear in my link graph, tag index, or search results.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. The walking skeleton story (VLT-0z7) introduced `maskInertContent()` in `inert.go`. This story extends the masking to **Obsidian-style comments** delimited by `%%`.\n\n### How Obsidian Comments Work\n- Delimited by `%%`: `%% this is a comment %%`\n- Can be inline: `text %% hidden %% more text`\n- Can span multiple lines:\n  ```\n  %%\n  This whole block\n  is hidden in preview\n  %%\n  ```\n- Obsidian renders these as invisible in preview mode\n- Content inside should NOT be parsed for links or tags\n- Comments are NOT the same as HTML comments (\u003c\\!-- --\u003e is separate)\n- `%%` can appear at start of line or mid-line\n\n### Implementation\nIn `inert.go`, add a masking pass for Obsidian comments. This should run AFTER fenced code block and inline code masking (so %% inside code is already masked and will not trigger comment detection).\n\nRegex pattern: `%%[\\s\\S]*?%%` with DOTALL semantics -- match opening %%, content (including newlines), closing %%. Mask everything between the delimiters (preserve the %% delimiters themselves for debugging).\n\n### Files to Modify\n- `inert.go` -- add Obsidian comment masking pass to maskInertContent()\n- `inert_test.go` -- add tests\n\nNo changes to consumer files needed.\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestMaskObsidianCommentInline` -- `text %% hidden %% more` masks the hidden part\n2. `TestMaskObsidianCommentMultiline` -- multiline %% block is fully masked\n3. `TestMaskObsidianCommentPreservesLength` -- output length equals input length\n4. `TestMaskObsidianCommentPreservesNewlines` -- newlines inside comment are preserved\n5. `TestMaskMultipleObsidianComments` -- multiple comments in one document\n6. `TestMaskObsidianCommentInsideFencedBlock` -- %% inside a code block is NOT treated as comment boundary (already masked)\n\n### Integration Tests (real files, no mocks)\n7. `TestParseWikilinksIgnoresObsidianComments` -- parseWikilinks() ignores [[Link]] inside %% comments\n8. `TestParseInlineTagsIgnoresObsidianComments` -- parseInlineTags() ignores #tag inside %% comments\n9. `TestFindBacklinksIgnoresObsidianComments` -- real vault (t.TempDir()): note with [[B]] inside %% comment. findBacklinks() returns empty.\n10. `TestMixedCodeAndComments` -- vault with links in code blocks AND comments. Only plain-text links detected.\n\n## Acceptance Criteria\n1. Inline Obsidian comments (%% ... %%) are masked\n2. Multiline Obsidian comments are masked\n3. %% inside already-masked code blocks do not trigger false comment boundaries\n4. parseWikilinks() ignores links in Obsidian comments\n5. parseInlineTags() ignores tags in Obsidian comments\n6. findBacklinks() ignores links in Obsidian comments\n7. All existing tests pass\n8. 10+ new tests, all passing\n9. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go patterns, regex. No specialized skill requirements.","acceptance_criteria":"1. Obsidian comments (%% ... %%) are masked (inline and multiline)\n2. %% inside code blocks does not trigger comment masking\n3. All consumer functions ignore links/tags in comments\n4. All existing tests pass\n5. 10+ new tests passing\n6. Zero external dependencies","status":"closed","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:23:06Z","created_by":"RamXX","updated_at":"2026-02-20T05:07:16Z","closed_at":"2026-02-20T05:07:16Z","close_reason":"Accepted: maskObsidianComments() correctly registered as third inert pass, masks inline and multiline %% comments while preserving delimiters and byte length, %% inside fenced code blocks not triggered, all 6 consumer functions (parseWikilinks, parseInlineTags, findBacklinks) ignore comment-interior content, 10 test functions/15 sub-tests all pass, zero regressions in full suite, zero external deps","labels":["2sp","accepted"],"dependencies":[{"issue_id":"VLT-i6l","depends_on_id":"VLT-0s5","type":"parent-child","created_at":"2026-02-19T20:23:10Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-i6l","depends_on_id":"VLT-0z7","type":"blocks","created_at":"2026-02-19T20:23:10Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":6,"issue_id":"VLT-i6l","author":"RamXX","text":"## Delivery Proof -- VLT-i6l\n\n### Implementation\nAdded maskObsidianComments() to inert.go as the third registered pass. Regex: (?s)%%(.+?)%% with maskRegion for content between delimiters. Preserves %% delimiters, newlines, and byte length.\n\n### Files: tools/vlt/inert.go (impl), tools/vlt/inert_test.go (10 new test functions)\n### Commit: 1150850 on main\n\n### All AC verified:\n1. Inline comments masked -- TestMaskObsidianCommentInline PASS\n2. Multiline comments masked -- TestMaskObsidianCommentMultiline PASS\n3. %% in code blocks safe -- TestMaskObsidianCommentInsideFencedBlock PASS\n4. parseWikilinks ignores -- TestParseWikilinksIgnoresObsidianComments PASS\n5. parseInlineTags ignores -- TestParseInlineTagsIgnoresObsidianComments PASS\n6. findBacklinks ignores -- TestFindBacklinksIgnoresObsidianComments PASS\n7. All existing tests pass -- Full suite 0 failures\n8. 10+ new tests passing -- 10 functions, 15+ sub-tests\n9. Zero external deps -- stdlib regexp only\n\nFull test suite: 100+ tests, ALL PASS, 0 regressions.","created_at":"2026-02-20T05:04:07Z"}]}
{"id":"VLT-m4j","title":"Add math block masking ($$ ... $$ and $ ... $) to inert zone infrastructure","description":"## User Story\nAs a vault user, I want wikilinks and tags inside math blocks ($$ ... $$ and $ ... $) to be ignored so that LaTeX expressions containing bracket-like syntax do not pollute my link graph or tag index.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only) for Obsidian vault operations. The walking skeleton story (VLT-0z7) introduced `maskInertContent()` in `inert.go`. This story extends the masking to **math blocks** (LaTeX/KaTeX).\n\n### How Math Blocks Work in Obsidian\n- **Display math** (block): `$$ ... $$` -- typically on its own lines, can span multiple lines\n  ```\n  $$\n  \\sum_{i=1}^{n} x_i\n  $$\n  ```\n- **Inline math**: `$ ... $` -- single-line, inline with text\n  - Example: `The formula $x = [[y]]$ is important` -- [[y]] here is NOT a wikilink\n- Dollar signs in normal text (like \"$50\") should NOT trigger math mode. Obsidian requires the opening $ to be followed by a non-space and the closing $ to be preceded by a non-space.\n- Math content often contains characters that look like wikilinks or tags (e.g., `\\mathbb{R}`, subscripts)\n\n### Implementation\nIn `inert.go`, add masking passes for math blocks. Order:\n1. Display math ($$...$$) first -- these are multiline and use double dollar signs\n2. Inline math ($...$) second -- single dollar signs, single line only\n\n**Display math regex**: `\\$\\$[\\s\\S]*?\\$\\$` -- match $$, content (including newlines), closing $$\n**Inline math regex**: `\\$([^\\s$][^$]*?[^\\s$])\\$` or simpler `\\$[^\\s$].*?[^\\s$]\\$` -- match $, non-whitespace content, closing $. Must NOT match `$50` or `$ text` (space after opening $).\n\nThis pass should run AFTER all other masking (code blocks, inline code, Obsidian comments, HTML comments).\n\n### Files to Modify\n- `inert.go` -- add math block masking passes to maskInertContent()\n- `inert_test.go` -- add tests\n\nNo changes to consumer files needed.\n\n## Testing Requirements (TDD)\n\n### Unit Tests\n1. `TestMaskDisplayMath` -- `$$ content $$` is masked\n2. `TestMaskDisplayMathMultiline` -- multiline $$ block is masked\n3. `TestMaskInlineMath` -- `$x + y$` is masked\n4. `TestMaskMathPreservesLength` -- output length equals input length\n5. `TestMaskMathDoesNotMatchDollarAmounts` -- `$50` and `$ text` are NOT masked\n6. `TestMaskMathInsideCodeBlock` -- $ inside fenced code is NOT double-masked\n7. `TestMaskMultipleMathExpressions` -- multiple inline and display math in one document\n\n### Integration Tests (real files, no mocks)\n8. `TestParseWikilinksIgnoresMathBlocks` -- parseWikilinks() ignores [[Link]] inside $$ and $ blocks\n9. `TestParseInlineTagsIgnoresMathBlocks` -- parseInlineTags() ignores #tag inside math blocks\n10. `TestFindBacklinksIgnoresMathBlocks` -- real vault: note with [[B]] inside $$ block. findBacklinks() returns empty.\n11. `TestAllInertZonesCombined` -- real vault with wikilinks and tags inside ALL zone types (fenced code, inline code, %% comments, HTML comments, display math, inline math) plus real links outside. Verify only the real links are detected.\n\n## Acceptance Criteria\n1. Display math blocks ($$ ... $$) are masked\n2. Inline math ($...$) is masked\n3. Dollar amounts like $50 are NOT masked (no false positives)\n4. Math inside already-masked zones does not trigger\n5. parseWikilinks() ignores links in math blocks\n6. parseInlineTags() ignores tags in math blocks\n7. findBacklinks() ignores links in math blocks\n8. All existing tests pass\n9. 11+ new tests, all passing\n10. Zero external dependencies\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go patterns, regex. No specialized skill requirements.","acceptance_criteria":"1. Display math ($$ ... $$) masked\n2. Inline math ($ ... $) masked\n3. Dollar amounts not false-positive masked\n4. All consumer functions ignore links/tags in math\n5. All existing tests pass\n6. 11+ new tests passing\n7. Zero external dependencies","status":"closed","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:23:49Z","created_by":"RamXX","updated_at":"2026-02-20T05:15:08Z","closed_at":"2026-02-20T05:15:08Z","close_reason":"Accepted: Math block masking (display 42120 and inline $) fully implemented in inert.go. All 11 new tests pass (7 unit + 4 integration, no mocks). Dollar-amount false positive protection verified. Full suite 154 tests, 0 failures. Zero external deps.","labels":["3sp","accepted"],"dependencies":[{"issue_id":"VLT-m4j","depends_on_id":"VLT-0s5","type":"parent-child","created_at":"2026-02-19T20:23:54Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-m4j","depends_on_id":"VLT-0z7","type":"blocks","created_at":"2026-02-19T20:23:55Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":8,"issue_id":"VLT-m4j","author":"RamXX","text":"Delivery Proof: All 11 new tests pass, full suite green (0 failures), zero external deps. Commit 4c71f00. See inert.go lines 162-217 for implementation, inert_test.go for tests. AC table verified in PR description.","created_at":"2026-02-20T05:12:21Z"}]}
{"id":"VLT-p02","title":"Output Formats and Obsidian Features -- TSV, Tree, Bookmarks, Templates, URI Generation","description":"This epic adds additional output formats (--tsv and --tree) to match the Obsidian CLI, plus filesystem-accessible Obsidian features: bookmarks management, template application, and obsidian:// URI generation. These are lower-priority features that enhance vlt's compatibility with the Obsidian ecosystem without requiring the Obsidian app to be running.","acceptance_criteria":"1. --tsv format supported across all list/table commands. 2. --tree format shows hierarchical folder structure. 3. Bookmarks can be listed, added, and removed via .obsidian/bookmarks.json. 4. Templates can be listed and applied with variable substitution. 5. obsidian:// URIs can be generated for any note. 6. All features have integration tests.","status":"open","priority":3,"issue_type":"epic","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:27:17Z","created_by":"RamXX","updated_at":"2026-02-20T04:27:17Z","labels":["milestone"]}
{"id":"VLT-zr3","title":"E2E validation: All inert zones correctly handled across full command suite","description":"## User Story\nAs a vault user, I want confidence that ALL inert zones (fenced code, inline code, Obsidian comments, HTML comments, display math, inline math) are correctly handled across ALL vlt commands that parse content.\n\n## Context\nvlt is a zero-dependency Go CLI (Go 1.24+, stdlib only). This is the final validation story for the Inert Zone Parsing epic (VLT-0s5). All zone types have been implemented in prior stories. This story provides comprehensive E2E validation that the entire system works correctly with realistic vault content.\n\nThis story does NOT add new masking code. It adds E2E tests that exercise the full command pipeline with complex, realistic content containing all inert zone types simultaneously.\n\n### What This Story Validates\nThe complete inert zone handling across all affected commands:\n- `backlinks` -- must not find links inside any inert zone\n- `links` -- must not report links inside any inert zone\n- `orphans` -- must correctly identify orphans when all incoming links are inside inert zones\n- `unresolved` -- must not report broken links that only appear inside inert zones\n- `tags` -- must not count tags inside any inert zone\n- `tag` -- must not find notes by tags that only appear inside inert zones\n- `search` -- SHOULD still find content inside inert zones (search scans everything)\n\n### Files to Modify\n- `inert_test.go` -- add comprehensive E2E tests\n\nNo production code changes. This is a validation-only story.\n\n## Testing Requirements\n\n### E2E Tests (real files, no mocks, t.TempDir())\n1. `TestE2EAllInertZonesBacklinks` -- Create vault with note A containing [[B]] in every inert zone type (6 zones) and one real [[B]] outside any zone. Verify findBacklinks returns A exactly once.\n2. `TestE2EAllInertZonesBacklinksAllMasked` -- Same but NO real link outside zones. findBacklinks returns empty.\n3. `TestE2EAllInertZonesOrphans` -- Note B is referenced only inside inert zones of note A. B must appear in orphans.\n4. `TestE2EAllInertZonesUnresolved` -- [[Missing]] appears inside all 6 zone types. None should appear in unresolved output.\n5. `TestE2EAllInertZonesTags` -- #mytag appears inside all 6 zone types plus one real occurrence in body text. Tag count must be 1.\n6. `TestE2EAllInertZonesTagSearch` -- Note with #special only inside inert zones. cmdTag(tag=\"special\") must not return the note.\n7. `TestE2ERealisticNote` -- A realistic Obsidian note with mixed content: frontmatter, headings, prose with real links, code examples with [[fake]] links, LaTeX with $[[x]]$ math, comments with hidden TODO links. Verify all commands produce correct results.\n8. `TestE2ESearchStillFindsInertContent` -- Search SHOULD find text inside inert zones (search is different from link/tag extraction). Verify cmdSearch finds content inside code blocks.\n9. `TestE2EMaskingDoesNotCorruptContent` -- After all operations, re-read the original files and verify they are byte-for-byte identical (masking is read-only, never writes masked content back).\n\n## Acceptance Criteria\n1. 9 E2E tests, all passing\n2. All 6 inert zone types tested in combination\n3. All affected commands verified (backlinks, links, orphans, unresolved, tags, tag)\n4. Search command verified to still find content inside inert zones\n5. Masking proven to be read-only (no file corruption)\n6. All prior tests still pass (zero regressions)\n7. Demoable: can show before/after comparison of vlt commands on a vault with mixed content\n\nMANDATORY SKILLS TO REVIEW:\n- None identified. Standard Go testing patterns. No specialized skill requirements.","acceptance_criteria":"1. 9 E2E tests all passing\n2. All 6 inert zone types tested in combination\n3. All affected commands verified\n4. Search still finds inert content\n5. Masking is read-only\n6. All prior tests pass\n7. Demoable end-to-end","status":"closed","priority":2,"issue_type":"task","owner":"ramxx@ramirosalas.com","created_at":"2026-02-20T04:24:21Z","created_by":"RamXX","updated_at":"2026-02-20T05:22:05Z","closed_at":"2026-02-20T05:22:05Z","close_reason":"Accepted: 9/9 E2E tests verified live (181 total, 0 failures). All 6 inert zone types (fenced code, inline code, Obsidian comment, HTML comment, display math, inline math) tested across all affected commands (backlinks, links, orphans, unresolved, tags, tag). Search correctly finds inert content. Masking proven read-only byte-for-byte. Zero regressions. Commit e88cc42 confirmed.","labels":["3sp","accepted"],"dependencies":[{"issue_id":"VLT-zr3","depends_on_id":"VLT-0s5","type":"parent-child","created_at":"2026-02-19T20:24:26Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-zr3","depends_on_id":"VLT-7fi","type":"blocks","created_at":"2026-02-19T20:24:26Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-zr3","depends_on_id":"VLT-h6k","type":"blocks","created_at":"2026-02-19T20:24:27Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-zr3","depends_on_id":"VLT-i6l","type":"blocks","created_at":"2026-02-19T20:24:26Z","created_by":"RamXX","metadata":"{}"},{"issue_id":"VLT-zr3","depends_on_id":"VLT-m4j","type":"blocks","created_at":"2026-02-19T20:24:27Z","created_by":"RamXX","metadata":"{}"}],"comments":[{"id":9,"issue_id":"VLT-zr3","author":"RamXX","text":"Delivery Proof: 9/9 E2E tests PASS, 130 total tests 0 regressions. All 6 zone types tested across backlinks/links/orphans/unresolved/tags/tag/search. Masking proven read-only. Commit e88cc42. File: tools/vlt/inert_test.go (+646 lines).","created_at":"2026-02-20T05:19:34Z"}]}
